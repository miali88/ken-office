/*! For license information please see word-main.js.LICENSE.txt */
"use strict";(self.webpackChunkkenneth_office_addin_unified=self.webpackChunkkenneth_office_addin_unified||[]).push([[71],{81957:function(t,e,n){function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return o(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,i=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,c=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw c}}}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function a(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,a){var i=r&&r.prototype instanceof l?r:l,u=Object.create(i.prototype);return c(u,"_invoke",function(n,r,o){var a,c,i,l=0,u=o||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,c=0,i=t,f.n=n,s}};function p(n,r){for(c=n,i=r,e=0;!d&&l&&!o&&e<u.length;e++){var o,a=u[e],p=f.p,h=a[2];n>3?(o=h===r)&&(i=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,c=0))}if(o||n>1)return s;throw d=!0,r}return function(o,u,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),c=u,i=h;(e=c<2?t:i)||!d;){a||(c?c<3?(c>1&&(f.n=-1),p(c,i)):f.n=i:f.v=i);try{if(l=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,i)))throw TypeError("iterator result is not an object");if(!e.done)return e;i=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((e=(d=f.n<0)?i:n.call(r,f))!==s)break}catch(e){a=t,c=1,i=e}finally{l=1}}return{value:e,done:d}}}(n,o,a),!0),u}var s={};function l(){}function u(){}function d(){}e=Object.getPrototypeOf;var f=[][r]?e(e([][r]())):(c(e={},r,function(){return this}),e),p=d.prototype=l.prototype=Object.create(f);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,o,"GeneratorFunction")),t.prototype=Object.create(p),t}return u.prototype=d,c(p,"constructor",d),c(d,"constructor",u),u.displayName="GeneratorFunction",c(d,o,"GeneratorFunction"),c(p),c(p,o,"Generator"),c(p,r,function(){return this}),c(p,"toString",function(){return"[object Generator]"}),(a=function(){return{w:i,m:h}})()}function c(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}c=function(t,e,n,r){function a(e,n){c(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},c(t,e,n,r)}function i(t,e,n,r,o,a,c){try{var i=t[a](c),s=i.value}catch(t){return void n(t)}i.done?e(s):Promise.resolve(s).then(r,o)}function s(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function c(t){i(a,r,o,c,s,"next",t)}function s(t){i(a,r,o,c,s,"throw",t)}c(void 0)})}}function l(){return u.apply(this,arguments)}function u(){return u=s(a().m(function t(){var e,n,r,o,c,i,s,l,u,f,h,y,b,m,v,x,w,k;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e=document.getElementById("rewrite-status"),n=document.getElementById("progress-container"),r=document.getElementById("progress-bar"),o=document.getElementById("progress-text"),c=document.getElementById("ai-rewrite-btn"),e&&c){t.n=1;break}return alert("Required UI elements not found"),t.a(2);case 1:return i=[],s=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=(new Date).toLocaleTimeString(),o="".concat(r," ").concat(t);i.push(o),console.log(o);var a=n?"#d32f2f":"#666";e.innerHTML='\n      <div style="padding: 12px; background: '.concat(n?"#ffebee":"#f5f5f5","; border-radius: 4px; border: 1px solid ").concat(n?"#ef5350":"#ddd",';">\n        <div style="margin-bottom: 8px; font-weight: bold; color: ').concat(a,';">').concat(t,'</div>\n        <div style="max-height: 200px; overflow-y: auto; font-size: 11px; font-family: monospace; background: white; padding: 8px; border-radius: 4px;">\n          ').concat(i.map(function(t){return'<div style="margin: 2px 0;">'.concat(t,"</div>")}).join(""),"\n        </div>\n      </div>\n    ")},t.p=2,c.disabled=!0,n&&(n.style.display="block"),s("üìñ STEP 1/3: Extracting document text..."),o&&(o.textContent="Step 1/3: Reading document"),r&&(r.style.width="10%"),t.p=3,s("  Loading document body..."),t.n=4,d();case 4:l=t.v,s("  ‚úÖ Extracted ".concat(l.text.length," chars, ").concat(l.placeholders.length," placeholders")),r&&(r.style.width="33%"),t.n=6;break;case 5:throw t.p=5,v=t.v,u=v instanceof Error?v.message:String(v),s("‚ùå EXTRACTION FAILED: ".concat(u),!0),new Error("Step 1 failed: ".concat(u));case 6:return s("ü§ñ STEP 2/3: Sending to backend..."),o&&(o.textContent="Step 2/3: AI processing"),r&&(r.style.width="40%"),t.p=7,s("  Connecting to http://localhost:3001/api/word-agent/rewrite"),s("  Payload size: ".concat(JSON.stringify({documentText:l.text}).length," bytes")),t.n=8,p(l,s);case 8:f=t.v,s("  ‚úÖ Backend returned ".concat(f.length," operations")),r&&(r.style.width="66%"),t.n=10;break;case 9:throw t.p=9,x=t.v,h=x instanceof Error?x.message:String(x),s("‚ùå BACKEND REQUEST FAILED: ".concat(h),!0),(h.includes("fetch")||h.includes("connect")||h.includes("Failed to fetch"))&&s("üí° Is the backend running? Check: http://localhost:3001",!0),new Error("Step 2 failed: ".concat(h));case 10:return s("‚úçÔ∏è STEP 3/3: Applying changes to document..."),o&&(o.textContent="Step 3/3: Applying changes"),r&&(r.style.width="75%"),t.p=11,t.n=12,g(f);case 12:s("  ‚úÖ Applied all ".concat(f.length," operations")),r&&(r.style.width="100%"),t.n=14;break;case 13:throw t.p=13,w=t.v,y=w instanceof Error?w.message:String(w),s("‚ùå EXECUTION FAILED: ".concat(y),!0),new Error("Step 3 failed: ".concat(y));case 14:e.innerHTML='\n      <div style="padding: 12px; background: #e8f5e9; border: 2px solid #4caf50; border-radius: 4px;">\n        <div style="color: #2e7d32; font-weight: bold; margin-bottom: 8px;">‚úÖ Document updated successfully!</div>\n        <div style="max-height: 200px; overflow-y: auto; font-size: 11px; font-family: monospace; background: white; padding: 8px; border-radius: 4px;">\n          '.concat(i.map(function(t){return'<div style="margin: 2px 0;">'.concat(t,"</div>")}).join(""),"\n        </div>\n      </div>\n    "),o&&(o.textContent="Complete!"),setTimeout(function(){n&&(n.style.display="none")},3e3),t.n=16;break;case 15:t.p=15,k=t.v,console.error("[FATAL ERROR]",k),b=k instanceof Error?k.message:String(k),m=k instanceof Error?k.stack:"",e.innerHTML='\n      <div style="padding: 12px; background: #ffebee; border: 2px solid #d32f2f; border-radius: 4px;">\n        <div style="color: #d32f2f; font-weight: bold; margin-bottom: 8px; font-size: 16px;">‚ùå PROCESS FAILED</div>\n        <div style="margin-bottom: 12px; color: #333; font-size: 14px;">'.concat(b,'</div>\n        <div style="margin-bottom: 12px; max-height: 200px; overflow-y: auto; font-size: 11px; font-family: monospace; background: white; padding: 8px; border-radius: 4px;">\n          ').concat(i.map(function(t){return'<div style="margin: 2px 0;">'.concat(t,"</div>")}).join(""),'\n        </div>\n        <details style="margin-top: 8px;">\n          <summary style="cursor: pointer; color: #d32f2f; font-size: 12px;">Show stack trace</summary>\n          <pre style="font-size: 10px; margin-top: 4px; background: #f5f5f5; padding: 8px; border-radius: 4px; overflow-x: auto; white-space: pre-wrap;">').concat(m||"No stack trace available","</pre>\n        </details>\n      </div>\n    "),o&&(o.textContent="FAILED",o.style.color="#d32f2f"),r&&(r.style.background="#d32f2f");case 16:return t.p=16,c.disabled=!1,t.f(16);case 17:return t.a(2)}},t,null,[[11,13],[7,9],[3,5],[2,15,16,17]])})),u.apply(this,arguments)}function d(){return f.apply(this,arguments)}function f(){return f=s(a().m(function t(){return a().w(function(t){for(;;)if(0===t.n)return t.a(2,Word.run(function(){var t=s(a().m(function t(e){var n,r,o,c;return a().w(function(t){for(;;)switch(t.n){case 0:return(n=e.document.body).load("text"),t.n=1,e.sync();case 1:return r=n.text,o=/\{\{[^}]+\}\}/g,c=Array.from(new Set(r.match(o)||[])),t.a(2,{text:r,tables:[],placeholders:c})}},t)}));return function(e){return t.apply(this,arguments)}}()))},t)})),f.apply(this,arguments)}function p(t,e){return h.apply(this,arguments)}function h(){return(h=s(a().m(function t(e,n){var r,o,c,i,s,l,u,d,f,p,h,g;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:return r={documentText:e.text,documentStructure:e,caseId:"cmfivedyx0001c96zlzkskb7b",useStructuredOperations:!0,instructions:"Fill in all placeholders with accurate case information"},n("  Request body created: ".concat(JSON.stringify(r).length," bytes")),t.p=1,n("  Making fetch() call..."),t.n=2,fetch("http://localhost:3001/api/word-agent/rewrite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 2:if(c=t.v,n("  Response received: ".concat(c.status," ").concat(c.statusText)),c.ok){t.n=6;break}return i="",t.p=3,t.n=4,c.text();case 4:throw i=t.v,n("  Error response: ".concat(i.substring(0,200)),!0),l=JSON.parse(i),new Error("API ".concat(c.status,": ").concat((null===(s=l.error)||void 0===s?void 0:s.message)||l.message||c.statusText));case 5:throw t.p=5,t.v,new Error("API ".concat(c.status,": ").concat(i.substring(0,200)||c.statusText));case 6:return t.n=7,c.text();case 7:u=t.v,n("  Response text length: ".concat(u.length," bytes")),t.p=8,d=JSON.parse(u),t.n=10;break;case 9:throw t.p=9,h=t.v,n("  JSON parse error: ".concat(h),!0),n("  Response preview: ".concat(u.substring(0,300)),!0),new Error("Invalid JSON from server");case 10:if(d.success){t.n=11;break}throw p=(null===(f=d.error)||void 0===f?void 0:f.message)||d.message||"Backend processing failed",n("  Backend reported failure: ".concat(p),!0),new Error(p);case 11:return n("  Success! Operations received: ".concat((null===(o=d.operations)||void 0===o?void 0:o.length)||0)),t.a(2,d.operations||[]);case 12:if(t.p=12,!((g=t.v)instanceof TypeError&&(g.message.includes("fetch")||g.message.includes("Failed to fetch")))){t.n=13;break}throw n("  Network error: Cannot connect to backend",!0),new Error("Cannot connect to http://localhost:3001 - Is the server running?");case 13:throw g;case 14:return t.a(2)}},t,null,[[8,9],[3,5],[1,12]])}))).apply(this,arguments)}function g(t){return y.apply(this,arguments)}function y(){return y=s(a().m(function t(e){return a().w(function(t){for(;;)if(0===t.n)return t.a(2,Word.run(function(){var t=s(a().m(function t(n){var r,o,c,i,s,l;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:console.log("[Operations] Starting execution, count:",e.length),n.document.changeTrackingMode=Word.ChangeTrackingMode.trackAll;try{n.document.properties.author="Kenneth AI",n.document.properties.load("author")}catch(t){console.warn("Could not set author:",t)}return t.n=1,n.sync();case 1:r=0,o=0,c=0;case 2:if(!(c<e.length)){t.n=17;break}i=e[c],console.log("[Operation ".concat(c+1,"/").concat(e.length,"] Type: ").concat(i.type)),t.p=3,s=i.type,t.n="fillTableCell"===s?4:"replacePlaceholder"===s?6:"replaceText"===s?8:"deleteText"===s?10:12;break;case 4:return t.n=5,b(n,i);case 5:return t.a(3,13);case 6:return t.n=7,v(n,i);case 7:return t.a(3,13);case 8:return t.n=9,w(n,i);case 9:return t.a(3,13);case 10:return t.n=11,T(n,i);case 11:return t.a(3,13);case 12:return console.warn("Unknown operation type:",i),o++,t.a(3,16);case 13:return t.n=14,n.sync();case 14:r++,t.n=16;break;case 15:t.p=15,l=t.v,o++,console.error("Operation ".concat(c," failed:"),l);case 16:c++,t.n=2;break;case 17:console.log("[Operations] Complete:",{total:e.length,success:r,failed:o});case 18:return t.a(2)}},t,null,[[3,15]])}));return function(e){return t.apply(this,arguments)}}()))},t)})),y.apply(this,arguments)}function b(t,e){return m.apply(this,arguments)}function m(){return(m=s(a().m(function t(e,n){var r,o,c,i,s,l;return a().w(function(t){for(;;)switch(t.n){case 0:return(r=e.document.body.tables).load("items"),t.n=1,e.sync();case 1:if(!(n.tableIndex>=r.items.length)){t.n=2;break}return console.warn("Table ".concat(n.tableIndex," not found")),t.a(2);case 2:return o=r.items[n.tableIndex],(c=o.rows).load("items"),t.n=3,e.sync();case 3:if(!(n.row>=c.items.length)){t.n=4;break}return console.warn("Row ".concat(n.row," not found")),t.a(2);case 4:return i=c.items[n.row],(s=i.cells).load("items"),t.n=5,e.sync();case 5:if(!(n.cell>=s.items.length)){t.n=6;break}return console.warn("Cell ".concat(n.cell," not found")),t.a(2);case 6:(l=s.items[n.cell]).body.clear(),l.body.insertText(n.value,Word.InsertLocation.start);case 7:return t.a(2)}},t)}))).apply(this,arguments)}function v(t,e){return x.apply(this,arguments)}function x(){return(x=s(a().m(function t(e,n){var o,c,i,s,l,u,d,f,p,h,g,y,b,m,v;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:return o=n.target.length>200,c=n.target,o&&(i=n.target.match(/^(\{\{[\s]*[A-Z_0-9]+[\s]*:)/),c=i?i[1]:n.target.substring(0,100)),(s=e.document.body.search(c,{matchCase:!1,matchWholeWord:!1})).load("items"),t.n=1,e.sync();case 1:if(0!==s.items.length){t.n=2;break}return console.warn("Placeholder not found: ".concat(c)),t.a(2);case 2:if(l=0,!o){t.n=14;break}u=r(s.items),t.p=3,u.s();case 4:if((d=u.n()).done){t.n=10;break}return f=d.value,t.p=5,(p=f.paragraphs.getFirst()).load("text"),t.n=6,e.sync();case 6:if(h=p.text,-1===(g=h.indexOf(n.target))){t.n=7;break}if(y=h.substring(0,g)+n.value+h.substring(g+n.target.length),p.clear(),p.insertText(y,Word.InsertLocation.start),l++,!1!==n.replaceAll){t.n=7;break}return t.a(3,10);case 7:t.n=9;break;case 8:if(t.p=8,t.v,f.insertText(n.value,Word.InsertLocation.replace),l++,!1!==n.replaceAll){t.n=9;break}return t.a(3,10);case 9:t.n=4;break;case 10:t.n=12;break;case 11:t.p=11,v=t.v,u.e(v);case 12:return t.p=12,u.f(),t.f(12);case 13:t.n=15;break;case 14:if(!1!==n.replaceAll){b=r(s.items);try{for(b.s();!(m=b.n()).done;)m.value.insertText(n.value,Word.InsertLocation.replace),l++}catch(t){b.e(t)}finally{b.f()}}else s.items[0].insertText(n.value,Word.InsertLocation.replace),l=1;case 15:console.log("Replaced ".concat(l," occurrences"));case 16:return t.a(2)}},t,null,[[5,8],[3,11,12,13]])}))).apply(this,arguments)}function w(t,e){return k.apply(this,arguments)}function k(){return(k=s(a().m(function t(e,n){var o,c,i;return a().w(function(t){for(;;)switch(t.n){case 0:return(o=e.document.body.search(n.target,{matchCase:n.matchCase||!1,matchWholeWord:n.matchWholeWord||!1})).load("items"),t.n=1,e.sync();case 1:if(0!==o.items.length){t.n=2;break}return console.warn("Text not found: ".concat(n.target)),t.a(2);case 2:c=r(o.items);try{for(c.s();!(i=c.n()).done;)i.value.insertText(n.value,Word.InsertLocation.replace)}catch(t){c.e(t)}finally{c.f()}case 3:return t.a(2)}},t)}))).apply(this,arguments)}function T(t,e){return E.apply(this,arguments)}function E(){return(E=s(a().m(function t(e,n){var o,c,i;return a().w(function(t){for(;;)switch(t.n){case 0:return(o=e.document.body.search(n.target,{matchCase:!1,matchWholeWord:!1})).load("items"),t.n=1,e.sync();case 1:if(0!==o.items.length){t.n=2;break}return console.warn("Text not found: ".concat(n.target)),t.a(2);case 2:c=r(o.items);try{for(c.s();!(i=c.n()).done;)i.value.delete()}catch(t){c.e(t)}finally{c.f()}case 3:return t.a(2)}},t)}))).apply(this,arguments)}function S(t){return function(t){if(Array.isArray(t))return A(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return A(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var s=r&&r.prototype instanceof i?r:i,l=Object.create(s.prototype);return I(l,"_invoke",function(n,r,o){var a,i,s,l=0,u=o||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,i=0,s=t,f.n=n,c}};function p(n,r){for(i=n,s=r,e=0;!d&&l&&!o&&e<u.length;e++){var o,a=u[e],p=f.p,h=a[2];n>3?(o=h===r)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(i=0,f.v=r,f.n=a[1]):p<h&&(o=n<3||a[0]>r||r>h)&&(a[4]=n,a[5]=r,f.n=h,i=0))}if(o||n>1)return c;throw d=!0,r}return function(o,u,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),i=u,s=h;(e=i<2?t:s)||!d;){a||(i?i<3?(i>1&&(f.n=-1),p(i,s)):f.n=s:f.v=s);try{if(l=2,a){if(i||(o="next"),e=a[o]){if(!(e=e.call(a,s)))throw TypeError("iterator result is not an object");if(!e.done)return e;s=e.value,i<2&&(i=0)}else 1===i&&(e=a.return)&&e.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=t}else if((e=(d=f.n<0)?s:n.call(r,f))!==c)break}catch(e){a=t,i=1,s=e}finally{l=1}}return{value:e,done:d}}}(n,o,a),!0),l}var c={};function i(){}function s(){}function l(){}e=Object.getPrototypeOf;var u=[][r]?e(e([][r]())):(I(e={},r,function(){return this}),e),d=l.prototype=i.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,I(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return s.prototype=l,I(d,"constructor",l),I(l,"constructor",s),s.displayName="GeneratorFunction",I(l,o,"GeneratorFunction"),I(d),I(d,o,"Generator"),I(d,r,function(){return this}),I(d,"toString",function(){return"[object Generator]"}),(C=function(){return{w:a,m:f}})()}function I(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}I=function(t,e,n,r){function a(e,n){I(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},I(t,e,n,r)}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function O(t,e,n,r,o,a,c){try{var i=t[a](c),s=i.value}catch(t){return void n(t)}i.done?e(s):Promise.resolve(s).then(r,o)}function j(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function c(t){O(a,r,o,c,i,"next",t)}function i(t){O(a,r,o,c,i,"throw",t)}c(void 0)})}}function L(){console.log("[Word] Initializing Word add-in...");var t=document.getElementById("app-container");if(t){var e,n;t.innerHTML='\n    <div style="width: 100%; height: 100vh; display: flex; flex-direction: column; background: white; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;">\n      \x3c!-- Tab Navigation --\x3e\n      <div style="display: flex; background: #1e1e1e; border-bottom: 1px solid #666;">\n        <button class="tab-button active" data-tab="drafting" style="flex: 1; padding: 12px; background: #2d2d2d; color: white; border: none; cursor: pointer;">Drafting</button>\n        <button class="tab-button" data-tab="ai-chat" style="flex: 1; padding: 12px; background: #1e1e1e; color: #999; border: none; cursor: pointer;">AI Chat</button>\n      </div>\n\n      \x3c!-- Drafting Tab Content --\x3e\n      <div id="drafting-tab" class="tab-content active" style="display: flex; flex: 1; background: white; padding: 20px; overflow: auto; flex-direction: column; align-items: center; justify-content: flex-start;">\n        \x3c!-- DEBUG: Test Backend Connection --\x3e\n        <div style="width: 100%; max-width: 500px; margin-bottom: 20px; padding: 16px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">\n          <h3 style="margin-bottom: 8px; color: #856404;">üîß Debug Test</h3>\n          <button id="test-ping-btn" style="width: 100%; padding: 10px; background: #ffc107; color: #000; border: none; border-radius: 4px; font-weight: 600; cursor: pointer; margin-bottom: 8px;">\n            Test Ping Backend (port 3001)\n          </button>\n          <div id="test-result" style="font-size: 12px; color: #856404; font-family: monospace; white-space: pre-wrap; max-height: 200px; overflow-y: auto;"></div>\n        </div>\n\n        \x3c!-- AI Rewrite Section --\x3e\n        <div style="width: 100%; max-width: 500px; margin-bottom: 30px;">\n          <h3 style="margin-bottom: 12px; color: #333;">ü§ñ AI Document Rewrite</h3>\n          <p style="font-size: 14px; color: #666; margin-bottom: 16px;">\n            Send entire document to AI for intelligent rewriting with track changes\n          </p>\n          <button id="ai-rewrite-btn" style="width: 100%; padding: 14px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;">\n            ‚ú® AI Rewrite Document\n          </button>\n          <div id="rewrite-status" style="margin-top: 12px; text-align: center; color: #666; font-size: 14px;"></div>\n\n          \x3c!-- Progress Bar --\x3e\n          <div id="progress-container" style="display: none; margin-top: 16px;">\n            <div id="progress-text" style="font-size: 13px; color: #666; margin-bottom: 8px;">Processing...</div>\n            <div style="width: 100%; height: 8px; background: #f0f0f0; border-radius: 4px; overflow: hidden;">\n              <div id="progress-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); transition: width 0.3s ease;"></div>\n            </div>\n          </div>\n        </div>\n\n\n\n      \x3c!-- AI Chat Tab Content --\x3e\n      <div id="ai-chat-tab" class="tab-content" style="display: none; flex: 1; background: white; padding: 20px;">\n        <div style="text-align: center; color: #999;">\n          <h3>AI Chat</h3>\n          <p>Chat functionality will be added in the next phase</p>\n        </div>\n      </div>\n    </div>\n  ',console.log("[Word] HTML injected successfully"),e=document.querySelectorAll(".tab-button"),n=document.querySelectorAll(".tab-content"),e.forEach(function(t){t.addEventListener("click",function(){var r=t.getAttribute("data-tab");e.forEach(function(t){t.classList.remove("active"),t.style.background="#1e1e1e",t.style.color="#999"}),n.forEach(function(t){t.classList.remove("active"),t.style.display="none"}),t.classList.add("active"),t.style.background="#2d2d2d",t.style.color="white";var o=document.getElementById("".concat(r,"-tab"));o&&(o.classList.add("active"),o.style.display="flex")})});var r=document.getElementById("ai-rewrite-btn"),o=document.getElementById("ai-autofill-btn"),a=document.getElementById("test-ping-btn");r&&(r.onclick=l),o&&(o.onclick=R),a&&(a.onclick=B),console.log("[Word] All handlers wired up")}else console.error("[Word] app-container not found!")}function P(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.createElement("div");n.style.cssText="\n    position: fixed; top: 20px; right: 20px;\n    padding: 16px 24px; border-radius: 8px;\n    color: white; font-weight: 600; z-index: 9999;\n    background: ".concat("success"===e?"#10b981":"error"===e?"#ef4444":"#3b82f6",";\n    box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n    animation: slideIn 0.3s ease;\n  "),n.textContent=t,document.body.appendChild(n),setTimeout(function(){n.style.animation="slideOut 0.3s ease",setTimeout(function(){return n.remove()},300)},3e3)}function B(){return z.apply(this,arguments)}function z(){return(z=j(C().m(function t(){var e,n,r,o,a,c,i,s,l,u,d,f,p,h;return C().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e=document.getElementById("test-result"),n=document.getElementById("test-ping-btn"),e&&n){t.n=1;break}return t.a(2);case 1:return n.disabled=!0,e.textContent="Running comprehensive diagnostics...\n\n",e.textContent+="TEST 1: Basic fetch capability\n",t.p=2,t.n=3,fetch("https://jsonplaceholder.typicode.com/todos/1");case 3:return r=t.v,t.n=4,r.json();case 4:o=t.v,e.textContent+="‚úÖ Fetch works! Got external data: ".concat(o.title,"\n\n"),t.n=6;break;case 5:return t.p=5,p=t.v,e.textContent+="‚ùå Fetch completely blocked: ".concat(p instanceof Error?p.message:"Unknown","\n"),n.disabled=!1,t.a(2);case 6:a=["/api/word-agent/rewrite","https://localhost:3000/api/word-agent/rewrite","http://localhost:3001/api/word-agent/rewrite"],e.textContent+="TEST 2: Localhost variations\n",c=0,i=a;case 7:if(!(c<i.length)){t.n=14;break}return s=i[c],e.textContent+="\nTrying: ".concat(s,"\n"),t.p=8,l=Date.now(),t.n=9,fetch(s,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({documentText:"Test",caseId:"test",instructions:"Test"})});case 9:return u=t.v,d=Date.now()-l,e.textContent+="  ‚úÖ Connected! (".concat(d,"ms)\n"),e.textContent+="  Status: ".concat(u.status,"\n"),t.n=10,u.text();case 10:if(f=t.v,e.textContent+="  Response: ".concat(f.substring(0,100),"\n"),!u.ok){t.n=11;break}return e.textContent+="\nüéâ SUCCESS! Use this URL: ".concat(s,"\n"),t.a(3,14);case 11:t.n=13;break;case 12:t.p=12,h=t.v,e.textContent+="  ‚ùå Failed: ".concat(h instanceof Error?h.message:"Unknown","\n");case 13:c++,t.n=7;break;case 14:e.textContent+="\n\nTEST 3: Environment info\n",e.textContent+="Current origin: ".concat(window.location.origin,"\n"),e.textContent+="Current URL: ".concat(window.location.href,"\n"),e.textContent+="Protocol: ".concat(window.location.protocol,"\n"),n.disabled=!1;case 15:return t.a(2)}},t,null,[[8,12],[2,5]])}))).apply(this,arguments)}function R(){return W.apply(this,arguments)}function W(){return W=j(C().m(function t(){var e,n,r,o,a,c,i,s;return C().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e=document.getElementById("autofill-status"),n=document.getElementById("autofill-results"),r=document.getElementById("ai-autofill-btn"),e&&n&&r){t.n=1;break}return P("Required elements not found","error"),t.a(2);case 1:return t.p=1,r.disabled=!0,e.textContent="Analyzing document...",n.innerHTML="",t.n=2,Word.run(function(){var t=j(C().m(function t(e){var n,r,o,a;return C().w(function(t){for(;;)switch(t.n){case 0:return e.document.body.load("text"),t.n=1,e.sync();case 1:for(n=e.document.body.text,r=/\{\{([^}]+)\}\}/g,o=[];null!==(a=r.exec(n));)o.push(a[1]);return t.a(2,{documentText:n,placeholders:S(new Set(o))})}},t)}));return function(e){return t.apply(this,arguments)}}());case 2:return o=t.v,e.textContent="Searching case files...",t.n=3,fetch("/api/cases/".concat("cmfivedyx0001c96zlzkskb7b","/doc-gen"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({documentText:o.documentText,placeholders:o.placeholders})});case 3:if((a=t.v).ok){t.n=4;break}throw new Error("API request failed: ".concat(a.statusText));case 4:return t.n=5,a.json();case 5:c=t.v,e.textContent="‚úì Analysis complete!",c.suggestions&&c.suggestions.length>0?(i=c.suggestions.map(function(t){return'\n        <div style="padding: 12px; margin-bottom: 8px; background: #f5f5f5; border-radius: 6px; border-left: 4px solid #667eea;">\n          <div style="font-weight: bold; color: #333; margin-bottom: 4px;">'.concat(t.placeholder,'</div>\n          <div style="color: #666; font-size: 14px;">').concat(t.suggestedValue||"No suggestion found","</div>\n          ").concat(t.source?'<div style="color: #999; font-size: 12px; margin-top: 4px;">Source: '.concat(t.source,"</div>"):"","\n        </div>\n      ")}).join(""),n.innerHTML=i,P("Autofill complete!","success")):n.innerHTML='<div style="color: #999; text-align: center;">No suggestions found</div>',t.n=7;break;case 6:t.p=6,s=t.v,console.error("[AI Autofill] Error:",s),e.textContent="Error: ".concat(s instanceof Error?s.message:"Unknown error"),e.style.color="#d32f2f",P("Autofill failed","error");case 7:return t.p=7,r.disabled=!1,t.f(7);case 8:return t.a(2)}},t,null,[[1,6,7,8]])})),W.apply(this,arguments)}n.r(e),n.d(e,{initialize:function(){return L}}),n(90254)}}]);
//# sourceMappingURL=word-main.js.map