/*! For license information please see word-main.js.LICENSE.txt */
"use strict";(self.webpackChunkkenneth_office_addin_unified=self.webpackChunkkenneth_office_addin_unified||[]).push([[71],{62774:function(e,t,n){n.r(t),n.d(t,{initialize:function(){return U}});var r=[{type:"replacePlaceholder",target:"{{company_name}}",value:"ABERDEEN HOUSE CARE LIMITED",replaceAll:!0,metadata:{confidence:"high",source:"case details"}},{type:"replaceText",target:"….",value:"10 September 2025",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replaceText",target:"(introducer)",value:"[TO BE COMPLETED - Introducer Name]",metadata:{confidence:"low",source:"manual input"}},{type:"replacePlaceholder",target:"{{ CONDITION_1: whether prior relationship has existed. EITHER: Prior to this date, neither the firm nor the proposed Liquidators have had any other involvement with the Company or its Director. OR: Prior to this date, the proposed liquidators have had involvement with the director….}}",value:"Prior to this date, neither the firm nor the proposed Liquidators have had any other involvement with the Company or its Director.",metadata:{confidence:"medium",source:"default assumption"}},{type:"replacePlaceholder",target:"{{our_firm_name}}",value:"Kenneth AI",replaceAll:!0,metadata:{confidence:"high",source:"case details"}},{type:"replacePlaceholder",target:"{{instruction_date}}",value:"10 September 2025",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{date_scheduled_for_s100}}",value:"13 September 2025",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{general_meeting_notice_date}}",value:"06 September 2025",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{general_meeting_datetime}}",value:"13 September 2025 at 10:00 AM",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{full_names_address_of_ip}}",value:"ABERDEEN HOUSE CARE LIMITED, 123 Fictional Lane, Anytown, AB1 2CD",replaceAll:!0,metadata:{confidence:"medium",source:"case details and searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{incorporation_date}}",value:"15 June 2011",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{company_reg_number}}",value:"07658860",replaceAll:!0,metadata:{confidence:"high",source:"case details"}},{type:"replacePlaceholder",target:"{{trading_address}}",value:"456 Business Road, Cityville, CV1 2EF",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{company_trading_activity}}",value:"Operating care homes",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"deleteText",target:"{{below table should be populated with list of previous registered addresses}}",metadata:{confidence:"high",reasoning:"Template instruction for table below"}},{type:"fillTableCell",tableIndex:0,row:1,cell:0,value:"15 June 2011",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:0,row:1,cell:1,value:"31 December 2023",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:0,row:1,cell:2,value:"789 Old Street, Townsville, TS1 2GH",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:0,row:2,cell:0,value:"01 January 2024",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:0,row:2,cell:1,value:"Current",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:0,row:2,cell:2,value:"Business Helpline Group Limited, 101 New Avenue, Metropolis, MT1 2IJ",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{equity_capital_structure}}",value:"is £100,000, comprising 100,000 Ordinary shares of £1 each",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"deleteText",target:"{{below table should list the name, shares and percentage of each shareholder}}",metadata:{confidence:"high",reasoning:"Template instruction for table below"}},{type:"fillTableCell",tableIndex:1,row:1,cell:0,value:"KOTECHA, Rakesh",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:1,row:1,cell:1,value:"50,000",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:1,row:1,cell:2,value:"50%",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:1,row:2,cell:0,value:"KOTECHA, Mahesh Vithaldas",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:1,row:2,cell:1,value:"50,000",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:1,row:2,cell:2,value:"50%",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"deleteText",target:"{{below table should list the schema for officers of the company}}",metadata:{confidence:"high",reasoning:"Template instruction for table below"}},{type:"fillTableCell",tableIndex:2,row:1,cell:0,value:"KOTECHA, Rakesh",metadata:{confidence:"high",source:"case details"}},{type:"fillTableCell",tableIndex:2,row:1,cell:1,value:"Director",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:1,cell:2,value:"15 June 2011",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:1,cell:3,value:"N/A",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:2,cell:0,value:"KOTECHA, Mahesh Vithaldas",metadata:{confidence:"high",source:"case details"}},{type:"fillTableCell",tableIndex:2,row:2,cell:1,value:"Director",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:2,cell:2,value:"15 June 2011",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:2,cell:3,value:"N/A",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:3,cell:0,value:"KOTECHA, Pragna",metadata:{confidence:"high",source:"case details"}},{type:"fillTableCell",tableIndex:2,row:3,cell:1,value:"Director",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:3,cell:2,value:"01 January 2015",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:3,cell:3,value:"N/A",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:4,cell:0,value:"KOTECHA, Trushali",metadata:{confidence:"high",source:"case details"}},{type:"fillTableCell",tableIndex:2,row:4,cell:1,value:"Director",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:4,cell:2,value:"01 January 2015",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:4,cell:3,value:"N/A",metadata:{confidence:"medium",source:"searchCaseDocuments"}}];function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,c=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw c}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,d=Object.create(c.prototype);return i(d,"_invoke",function(n,r,o){var a,c,i,s=0,d=o||[],u=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return a=t,c=0,i=e,p.n=n,l}};function f(n,r){for(c=n,i=r,t=0;!u&&s&&!o&&t<d.length;t++){var o,a=d[t],f=p.p,m=a[2];n>3?(o=m===r)&&(i=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=f&&((o=n<2&&f<a[1])?(c=0,p.v=r,p.n=a[1]):f<m&&(o=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,p.n=m,c=0))}if(o||n>1)return l;throw u=!0,r}return function(o,d,m){if(s>1)throw TypeError("Generator is already running");for(u&&1===d&&f(d,m),c=d,i=m;(t=c<2?e:i)||!u;){a||(c?c<3?(c>1&&(p.n=-1),f(c,i)):p.n=i:p.v=i);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(u=p.n<0)?i:n.call(r,p))!==l)break}catch(t){a=e,c=1,i=t}finally{s=1}}return{value:t,done:u}}}(n,o,a),!0),d}var l={};function s(){}function d(){}function u(){}t=Object.getPrototypeOf;var p=[][r]?t(t([][r]())):(i(t={},r,function(){return this}),t),f=u.prototype=s.prototype=Object.create(p);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,i(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return d.prototype=u,i(f,"constructor",u),i(u,"constructor",d),d.displayName="GeneratorFunction",i(u,o,"GeneratorFunction"),i(f),i(f,o,"Generator"),i(f,r,function(){return this}),i(f,"toString",function(){return"[object Generator]"}),(c=function(){return{w:a,m:m}})()}function i(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}i=function(e,t,n,r){function a(t,n){i(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},i(e,t,n,r)}function l(e,t,n,r,o,a,c){try{var i=e[a](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function c(e){l(a,r,o,c,i,"next",e)}function i(e){l(a,r,o,c,i,"throw",e)}c(void 0)})}}function d(){return u.apply(this,arguments)}function u(){return u=s(c().m(function e(){var t,n,r,o,a,i,l,s,d,u,f,h,y,g,v,x,w,k;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=document.getElementById("rewrite-status"),n=document.getElementById("progress-container"),r=document.getElementById("progress-bar"),o=document.getElementById("progress-text"),a=document.getElementById("ai-rewrite-btn"),t&&a){e.n=1;break}return alert("Required UI elements not found"),e.a(2);case 1:return i=[],l=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=(new Date).toLocaleTimeString(),o="".concat(r," ").concat(e);i.push(o),console.log(o);var a=n?"#d32f2f":"#666";t.innerHTML='\n      <div style="padding: 12px; background: '.concat(n?"#ffebee":"#f5f5f5","; border-radius: 4px; border: 1px solid ").concat(n?"#ef5350":"#ddd",';">\n        <div style="margin-bottom: 8px; font-weight: bold; color: ').concat(a,';">').concat(e,'</div>\n        <div style="max-height: 200px; overflow-y: auto; font-size: 11px; font-family: monospace; background: white; padding: 8px; border-radius: 4px;">\n          ').concat(i.map(function(e){return'<div style="margin: 2px 0;">'.concat(e,"</div>")}).join(""),"\n        </div>\n      </div>\n    ")},e.p=2,a.disabled=!0,n&&(n.style.display="block"),l("📖 STEP 1/3: Extracting document text..."),o&&(o.textContent="Step 1/3: Reading document"),r&&(r.style.width="10%"),e.p=3,l("  Loading document body..."),e.n=4,p();case 4:s=e.v,l("  ✅ Extracted ".concat(s.text.length," chars, ").concat(s.placeholders.length," placeholders")),r&&(r.style.width="33%"),e.n=6;break;case 5:throw e.p=5,v=e.v,d=v instanceof Error?v.message:String(v),l("❌ EXTRACTION FAILED: ".concat(d),!0),new Error("Step 1 failed: ".concat(d));case 6:return l("🤖 STEP 2/3: Loading mock AI response..."),o&&(o.textContent="Step 2/3: AI processing (mock data)"),r&&(r.style.width="40%"),e.p=7,l("  Loading pre-configured operations..."),e.n=8,m(s,l);case 8:u=e.v,l("  ✅ Loaded ".concat(u.length," operations from mock data")),r&&(r.style.width="66%"),e.n=10;break;case 9:throw e.p=9,x=e.v,f=x instanceof Error?x.message:String(x),l("❌ MOCK DATA LOADING FAILED: ".concat(f),!0),new Error("Step 2 failed: ".concat(f));case 10:return l("✍️ STEP 3/3: Applying changes to document..."),o&&(o.textContent="Step 3/3: Applying changes"),r&&(r.style.width="75%"),e.p=11,e.n=12,b(u);case 12:l("  ✅ Applied all ".concat(u.length," operations")),r&&(r.style.width="100%"),e.n=14;break;case 13:throw e.p=13,w=e.v,h=w instanceof Error?w.message:String(w),l("❌ EXECUTION FAILED: ".concat(h),!0),new Error("Step 3 failed: ".concat(h));case 14:t.innerHTML='\n      <div style="padding: 12px; background: #e8f5e9; border: 2px solid #4caf50; border-radius: 4px;">\n        <div style="color: #2e7d32; font-weight: bold; margin-bottom: 8px;">✅ Document updated successfully!</div>\n        <div style="max-height: 200px; overflow-y: auto; font-size: 11px; font-family: monospace; background: white; padding: 8px; border-radius: 4px;">\n          '.concat(i.map(function(e){return'<div style="margin: 2px 0;">'.concat(e,"</div>")}).join(""),"\n        </div>\n      </div>\n    "),o&&(o.textContent="Complete!"),setTimeout(function(){n&&(n.style.display="none")},3e3),e.n=16;break;case 15:e.p=15,k=e.v,console.error("[FATAL ERROR]",k),y=k instanceof Error?k.message:String(k),g=k instanceof Error?k.stack:"",t.innerHTML='\n      <div style="padding: 12px; background: #ffebee; border: 2px solid #d32f2f; border-radius: 4px;">\n        <div style="color: #d32f2f; font-weight: bold; margin-bottom: 8px; font-size: 16px;">❌ PROCESS FAILED</div>\n        <div style="margin-bottom: 12px; color: #333; font-size: 14px;">'.concat(y,'</div>\n        <div style="margin-bottom: 12px; max-height: 200px; overflow-y: auto; font-size: 11px; font-family: monospace; background: white; padding: 8px; border-radius: 4px;">\n          ').concat(i.map(function(e){return'<div style="margin: 2px 0;">'.concat(e,"</div>")}).join(""),'\n        </div>\n        <details style="margin-top: 8px;">\n          <summary style="cursor: pointer; color: #d32f2f; font-size: 12px;">Show stack trace</summary>\n          <pre style="font-size: 10px; margin-top: 4px; background: #f5f5f5; padding: 8px; border-radius: 4px; overflow-x: auto; white-space: pre-wrap;">').concat(g||"No stack trace available","</pre>\n        </details>\n      </div>\n    "),o&&(o.textContent="FAILED",o.style.color="#d32f2f"),r&&(r.style.background="#d32f2f");case 16:return e.p=16,a.disabled=!1,e.f(16);case 17:return e.a(2)}},e,null,[[11,13],[7,9],[3,5],[2,15,16,17]])})),u.apply(this,arguments)}function p(){return f.apply(this,arguments)}function f(){return f=s(c().m(function e(){return c().w(function(e){for(;;)if(0===e.n)return e.a(2,Word.run(function(){var e=s(c().m(function e(t){var n,r,o,a;return c().w(function(e){for(;;)switch(e.n){case 0:return(n=t.document.body).load("text"),e.n=1,t.sync();case 1:return r=n.text,o=/\{\{[^}]+\}\}/g,a=Array.from(new Set(r.match(o)||[])),e.a(2,{text:r,tables:[],placeholders:a})}},e)}));return function(t){return e.apply(this,arguments)}}()))},e)})),f.apply(this,arguments)}function m(e,t){return h.apply(this,arguments)}function h(){return(h=s(c().m(function e(t,n){return c().w(function(e){for(;;)switch(e.n){case 0:return n("  📦 Using hardcoded mock data (no backend required)"),e.n=1,new Promise(function(e){return setTimeout(e,800)});case 1:return n("  ✅ Mock data contains ".concat(r.length," operations")),n("  ℹ️  This is DEMO MODE - edit mockLLMResponse.ts to change operations"),e.a(2,r)}},e)}))).apply(this,arguments)}function b(e){return y.apply(this,arguments)}function y(){return y=s(c().m(function e(t){return c().w(function(e){for(;;)if(0===e.n)return e.a(2,Word.run(function(){var e=s(c().m(function e(n){var r,o,a,i,l,s;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:console.log("[Operations] Starting execution, count:",t.length),n.document.changeTrackingMode=Word.ChangeTrackingMode.trackAll;try{n.document.properties.author="Kenneth AI",n.document.properties.load("author")}catch(e){console.warn("Could not set author:",e)}return e.n=1,n.sync();case 1:r=0,o=0,a=0;case 2:if(!(a<t.length)){e.n=17;break}i=t[a],console.log("[Operation ".concat(a+1,"/").concat(t.length,"] Type: ").concat(i.type)),e.p=3,l=i.type,e.n="fillTableCell"===l?4:"replacePlaceholder"===l?6:"replaceText"===l?8:"deleteText"===l?10:12;break;case 4:return e.n=5,g(n,i);case 5:return e.a(3,13);case 6:return e.n=7,x(n,i);case 7:return e.a(3,13);case 8:return e.n=9,k(n,i);case 9:return e.a(3,13);case 10:return e.n=11,T(n,i);case 11:return e.a(3,13);case 12:return console.warn("Unknown operation type:",i),o++,e.a(3,16);case 13:return e.n=14,n.sync();case 14:r++,e.n=16;break;case 15:e.p=15,s=e.v,o++,console.error("Operation ".concat(a," failed:"),s);case 16:a++,e.n=2;break;case 17:console.log("[Operations] Complete:",{total:t.length,success:r,failed:o});case 18:return e.a(2)}},e,null,[[3,15]])}));return function(t){return e.apply(this,arguments)}}()))},e)})),y.apply(this,arguments)}function g(e,t){return v.apply(this,arguments)}function v(){return(v=s(c().m(function e(t,n){var r,o,a,i,l,s;return c().w(function(e){for(;;)switch(e.n){case 0:return(r=t.document.body.tables).load("items"),e.n=1,t.sync();case 1:if(!(n.tableIndex>=r.items.length)){e.n=2;break}return console.warn("Table ".concat(n.tableIndex," not found")),e.a(2);case 2:return o=r.items[n.tableIndex],(a=o.rows).load("items"),e.n=3,t.sync();case 3:if(!(n.row>=a.items.length)){e.n=4;break}return console.warn("Row ".concat(n.row," not found")),e.a(2);case 4:return i=a.items[n.row],(l=i.cells).load("items"),e.n=5,t.sync();case 5:if(!(n.cell>=l.items.length)){e.n=6;break}return console.warn("Cell ".concat(n.cell," not found")),e.a(2);case 6:(s=l.items[n.cell]).body.clear(),s.body.insertText(n.value,Word.InsertLocation.start);case 7:return e.a(2)}},e)}))).apply(this,arguments)}function x(e,t){return w.apply(this,arguments)}function w(){return(w=s(c().m(function e(t,n){var r,a,i,l,s,d,u,p,f,m,h,b,y,g,v;return c().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=n.target.length>200,a=n.target,r&&(i=n.target.match(/^(\{\{[\s]*[A-Z_0-9]+[\s]*:)/),a=i?i[1]:n.target.substring(0,100)),(l=t.document.body.search(a,{matchCase:!1,matchWholeWord:!1})).load("items"),e.n=1,t.sync();case 1:if(0!==l.items.length){e.n=2;break}return console.warn("Placeholder not found: ".concat(a)),e.a(2);case 2:if(s=0,!r){e.n=14;break}d=o(l.items),e.p=3,d.s();case 4:if((u=d.n()).done){e.n=10;break}return p=u.value,e.p=5,(f=p.paragraphs.getFirst()).load("text"),e.n=6,t.sync();case 6:if(m=f.text,-1===(h=m.indexOf(n.target))){e.n=7;break}if(b=m.substring(0,h)+n.value+m.substring(h+n.target.length),f.clear(),f.insertText(b,Word.InsertLocation.start),s++,!1!==n.replaceAll){e.n=7;break}return e.a(3,10);case 7:e.n=9;break;case 8:if(e.p=8,e.v,p.insertText(n.value,Word.InsertLocation.replace),s++,!1!==n.replaceAll){e.n=9;break}return e.a(3,10);case 9:e.n=4;break;case 10:e.n=12;break;case 11:e.p=11,v=e.v,d.e(v);case 12:return e.p=12,d.f(),e.f(12);case 13:e.n=15;break;case 14:if(!1!==n.replaceAll){y=o(l.items);try{for(y.s();!(g=y.n()).done;)g.value.insertText(n.value,Word.InsertLocation.replace),s++}catch(e){y.e(e)}finally{y.f()}}else l.items[0].insertText(n.value,Word.InsertLocation.replace),s=1;case 15:console.log("Replaced ".concat(s," occurrences"));case 16:return e.a(2)}},e,null,[[5,8],[3,11,12,13]])}))).apply(this,arguments)}function k(e,t){return C.apply(this,arguments)}function C(){return(C=s(c().m(function e(t,n){var r,a,i;return c().w(function(e){for(;;)switch(e.n){case 0:return(r=t.document.body.search(n.target,{matchCase:n.matchCase||!1,matchWholeWord:n.matchWholeWord||!1})).load("items"),e.n=1,t.sync();case 1:if(0!==r.items.length){e.n=2;break}return console.warn("Text not found: ".concat(n.target)),e.a(2);case 2:a=o(r.items);try{for(a.s();!(i=a.n()).done;)i.value.insertText(n.value,Word.InsertLocation.replace)}catch(e){a.e(e)}finally{a.f()}case 3:return e.a(2)}},e)}))).apply(this,arguments)}function T(e,t){return I.apply(this,arguments)}function I(){return(I=s(c().m(function e(t,n){var r,a,i;return c().w(function(e){for(;;)switch(e.n){case 0:return(r=t.document.body.search(n.target,{matchCase:!1,matchWholeWord:!1})).load("items"),e.n=1,t.sync();case 1:if(0!==r.items.length){e.n=2;break}return console.warn("Text not found: ".concat(n.target)),e.a(2);case 2:a=o(r.items);try{for(a.s();!(i=a.n()).done;)i.value.delete()}catch(e){a.e(e)}finally{a.f()}case 3:return e.a(2)}},e)}))).apply(this,arguments)}function E(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var l=r&&r.prototype instanceof i?r:i,s=Object.create(l.prototype);return A(s,"_invoke",function(n,r,o){var a,i,l,s=0,d=o||[],u=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return a=t,i=0,l=e,p.n=n,c}};function f(n,r){for(i=n,l=r,t=0;!u&&s&&!o&&t<d.length;t++){var o,a=d[t],f=p.p,m=a[2];n>3?(o=m===r)&&(l=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=f&&((o=n<2&&f<a[1])?(i=0,p.v=r,p.n=a[1]):f<m&&(o=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,p.n=m,i=0))}if(o||n>1)return c;throw u=!0,r}return function(o,d,m){if(s>1)throw TypeError("Generator is already running");for(u&&1===d&&f(d,m),i=d,l=m;(t=i<2?e:l)||!u;){a||(i?i<3?(i>1&&(p.n=-1),f(i,l)):p.n=l:p.v=l);try{if(s=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(u=p.n<0)?l:n.call(r,p))!==c)break}catch(t){a=e,i=1,l=t}finally{s=1}}return{value:t,done:u}}}(n,o,a),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var d=[][r]?t(t([][r]())):(A(t={},r,function(){return this}),t),u=s.prototype=i.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,A(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return l.prototype=s,A(u,"constructor",s),A(s,"constructor",l),l.displayName="GeneratorFunction",A(s,o,"GeneratorFunction"),A(u),A(u,o,"Generator"),A(u,r,function(){return this}),A(u,"toString",function(){return"[object Generator]"}),(E=function(){return{w:a,m:p}})()}function A(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}A=function(e,t,n,r){function a(t,n){A(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},A(e,t,n,r)}function O(e,t,n,r,o,a,c){try{var i=e[a](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,o)}function D(){return S.apply(this,arguments)}function S(){var e;return e=E().m(function e(){var t,n,r,o,a;return E().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=document.getElementById("test-result"),n=document.getElementById("test-ping-btn"),t&&n){e.n=1;break}return e.a(2);case 1:return n.disabled=!0,t.textContent="Running comprehensive diagnostics...\n\n",t.textContent+="TEST 1: Basic fetch capability\n",e.p=2,e.n=3,fetch("https://jsonplaceholder.typicode.com/todos/1");case 3:return r=e.v,e.n=4,r.json();case 4:o=e.v,t.textContent+="✅ Fetch works! Got external data: ".concat(o.title,"\n\n"),e.n=6;break;case 5:return e.p=5,a=e.v,t.textContent+="❌ Fetch completely blocked: ".concat(a instanceof Error?a.message:"Unknown","\n"),n.disabled=!1,e.a(2);case 6:t.textContent+="\n\nTEST 2: Environment info\n",t.textContent+="Current origin: ".concat(window.location.origin,"\n"),t.textContent+="Current URL: ".concat(window.location.href,"\n"),t.textContent+="Protocol: ".concat(window.location.protocol,"\n"),n.disabled=!1;case 7:return e.a(2)}},e,null,[[2,5]])}),S=function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function c(e){O(a,r,o,c,i,"next",e)}function i(e){O(a,r,o,c,i,"throw",e)}c(void 0)})},S.apply(this,arguments)}function P(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var l=r&&r.prototype instanceof i?r:i,s=Object.create(l.prototype);return j(s,"_invoke",function(n,r,o){var a,i,l,s=0,d=o||[],u=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return a=t,i=0,l=e,p.n=n,c}};function f(n,r){for(i=n,l=r,t=0;!u&&s&&!o&&t<d.length;t++){var o,a=d[t],f=p.p,m=a[2];n>3?(o=m===r)&&(l=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=f&&((o=n<2&&f<a[1])?(i=0,p.v=r,p.n=a[1]):f<m&&(o=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,p.n=m,i=0))}if(o||n>1)return c;throw u=!0,r}return function(o,d,m){if(s>1)throw TypeError("Generator is already running");for(u&&1===d&&f(d,m),i=d,l=m;(t=i<2?e:l)||!u;){a||(i?i<3?(i>1&&(p.n=-1),f(i,l)):p.n=l:p.v=l);try{if(s=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(u=p.n<0)?l:n.call(r,p))!==c)break}catch(t){a=e,i=1,l=t}finally{s=1}}return{value:t,done:u}}}(n,o,a),!0),s}var c={};function i(){}function l(){}function s(){}t=Object.getPrototypeOf;var d=[][r]?t(t([][r]())):(j(t={},r,function(){return this}),t),u=s.prototype=i.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,j(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return l.prototype=s,j(u,"constructor",s),j(s,"constructor",l),l.displayName="GeneratorFunction",j(s,o,"GeneratorFunction"),j(u),j(u,o,"Generator"),j(u,r,function(){return this}),j(u,"toString",function(){return"[object Generator]"}),(P=function(){return{w:a,m:p}})()}function j(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}j=function(e,t,n,r){function a(t,n){j(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},j(e,t,n,r)}function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function L(e,t,n,r,o,a,c){try{var i=e[a](c),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(r,o)}function B(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function c(e){L(a,r,o,c,i,"next",e)}function i(e){L(a,r,o,c,i,"throw",e)}c(void 0)})}}function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach(function(t){M(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function M(e,t,n){return(t=function(e){var t=function(e){if("object"!=_(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var F=[].concat([{id:"placeholders-filled",label:"All placeholders filled",description:"Verify all {{placeholder}} text has been replaced",checked:!1},{id:"tables-completed",label:"Tables completed",description:"Check all table cells contain correct data",checked:!1},{id:"dates-verified",label:"Dates verified",description:"Confirm all dates are accurate and formatted correctly",checked:!1},{id:"names-correct",label:"Names and entities correct",description:"Verify all company names, director names, and addresses",checked:!1},{id:"financial-data",label:"Financial data accurate",description:"Review share capital, shareholding percentages, and other figures",checked:!1},{id:"formatting-consistent",label:"Formatting consistent",description:"Check fonts, spacing, and styling throughout",checked:!1},{id:"track-changes-reviewed",label:"Track changes reviewed",description:"Accept or reject all tracked changes",checked:!1},{id:"final-proofread",label:"Final proofread complete",description:"Read through entire document for errors",checked:!1}]);function G(){var e=document.getElementById("checklist-items");if(e){var t=F.filter(function(e){return e.checked}).length,n=F.length,r=Math.round(t/n*100),o=document.getElementById("checklist-progress-bar"),a=document.getElementById("checklist-progress-text");o&&(o.style.width="".concat(r,"%"),o.style.background=100===r?"#10b981":"linear-gradient(90deg, #667eea 0%, #764ba2 100%)"),a&&(a.textContent="".concat(t," of ").concat(n," completed (").concat(r,"%)")),e.innerHTML=F.map(function(e){return'\n    <div class="checklist-item" style="padding: 12px; margin-bottom: 8px; background: '.concat(e.checked?"#f0fdf4":"#f9f9f9","; border-radius: 6px; border: 1px solid ").concat(e.checked?"#86efac":"#e0e0e0",'; cursor: pointer;" data-id="').concat(e.id,'">\n      <div style="display: flex; align-items: flex-start; gap: 12px;">\n        <div style="flex-shrink: 0; width: 20px; height: 20px; border-radius: 4px; border: 2px solid ').concat(e.checked?"#10b981":"#999","; background: ").concat(e.checked?"#10b981":"white",'; display: flex; align-items: center; justify-content: center; margin-top: 2px;">\n          ').concat(e.checked?'<span style="color: white; font-size: 14px;">✓</span>':"",'\n        </div>\n        <div style="flex: 1;">\n          <div style="font-weight: ').concat(e.checked?"600":"500","; color: ").concat(e.checked?"#059669":"#333","; margin-bottom: 4px; text-decoration: ").concat(e.checked?"line-through":"none",';">\n            ').concat(e.label,"\n          </div>\n          ").concat(e.description?'<div style="font-size: 12px; color: #666; line-height: 1.4;">'.concat(e.description,"</div>"):"","\n        </div>\n      </div>\n    </div>\n  ")}).join(""),e.querySelectorAll(".checklist-item").forEach(function(e){e.addEventListener("click",function(e){var t=e.currentTarget.getAttribute("data-id");t&&function(e){var t=F.find(function(t){return t.id===e});t&&(t.checked=!t.checked,G())}(t)})})}}function W(){F=F.map(function(e){return z(z({},e),{},{checked:!1})}),G(),q("Checklist reset","info")}function N(){return H.apply(this,arguments)}function H(){return H=B(P().m(function e(){var t,n;return P().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=document.getElementById("auto-check-btn")){e.n=1;break}return e.a(2);case 1:return t.disabled=!0,t.textContent="Checking...",e.p=2,e.n=3,Word.run(function(){var e=B(P().m(function e(t){var n,r,o,a,c;return P().w(function(e){for(;;)switch(e.n){case 0:return(n=t.document.body).load("text"),e.n=1,t.sync();case 1:r=n.text,o=/\{\{[^}]+\}\}/g,(a=r.match(o))&&0!==a.length||(c=F.find(function(e){return"placeholders-filled"===e.id}))&&(c.checked=!0),G(),q("Auto-check complete!","success");case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 3:e.n=5;break;case 4:e.p=4,n=e.v,console.error("Auto-check failed:",n),q("Auto-check failed","error");case 5:return e.p=5,t.disabled=!1,t.textContent="🔍 Auto-check Document",e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])})),H.apply(this,arguments)}function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.createElement("div");n.style.cssText="\n    position: fixed; top: 20px; right: 20px;\n    padding: 16px 24px; border-radius: 8px;\n    color: white; font-weight: 600; z-index: 9999;\n    background: ".concat("success"===t?"#10b981":"error"===t?"#ef4444":"#3b82f6",";\n    box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n    animation: slideIn 0.3s ease;\n  "),n.textContent=e,document.body.appendChild(n),setTimeout(function(){n.style.animation="slideOut 0.3s ease",setTimeout(function(){return n.remove()},300)},3e3)}function U(){console.log("[Word] Initializing Word add-in...");var e,t,n,r,o=document.getElementById("app-container");o?(o.innerHTML='\n    <div style="width: 100%; height: 100vh; display: flex; flex-direction: column; background: white; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;">\n      \x3c!-- Tab Navigation --\x3e\n      <div style="display: flex; background: #1e1e1e; border-bottom: 1px solid #666;">\n        <button class="tab-button active" data-tab="drafting" style="flex: 1; padding: 12px; background: #2d2d2d; color: white; border: none; cursor: pointer; font-weight: 600;">Drafting</button>\n        <button class="tab-button" data-tab="checklist" style="flex: 1; padding: 12px; background: #1e1e1e; color: #999; border: none; cursor: pointer; font-weight: 600;">Checklist</button>\n        <button class="tab-button" data-tab="ai-chat" style="flex: 1; padding: 12px; background: #1e1e1e; color: #999; border: none; cursor: pointer; font-weight: 600;">AI Chat</button>\n      </div>\n\n      \x3c!-- Tab Content Areas --\x3e\n      '.concat('\n    <div id="drafting-tab" class="tab-content active" style="display: flex; flex: 1; background: white; padding: 20px; overflow: auto; flex-direction: column; align-items: center; justify-content: flex-start;">\n      \x3c!-- DEBUG: Test Backend Connection --\x3e\n      <div style="width: 100%; max-width: 500px; margin-bottom: 20px; padding: 16px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">\n        <h3 style="margin-bottom: 8px; color: #856404;">🔧 Debug Test</h3>\n        <button id="test-ping-btn" style="width: 100%; padding: 10px; background: #ffc107; color: #000; border: none; border-radius: 4px; font-weight: 600; cursor: pointer; margin-bottom: 8px;">\n          Test Network Connection\n        </button>\n        <div id="test-result" style="font-size: 12px; color: #856404; font-family: monospace; white-space: pre-wrap; max-height: 200px; overflow-y: auto;"></div>\n      </div>\n\n      \x3c!-- AI Rewrite Section --\x3e\n      <div style="width: 100%; max-width: 500px; margin-bottom: 30px;">\n        <h3 style="margin-bottom: 12px; color: #333;">🤖 AI Document Rewrite (Demo Mode)</h3>\n        <p style="font-size: 14px; color: #666; margin-bottom: 8px;">\n          Fill placeholders and tables using mock AI operations (no backend required)\n        </p>\n        <p style="font-size: 12px; color: #999; margin-bottom: 16px; padding: 8px; background: #f9f9f9; border-radius: 4px; border-left: 3px solid #667eea;">\n          💡 This demo uses hardcoded data from <code>mockLLMResponse.ts</code>\n        </p>\n        <button id="ai-rewrite-btn" style="width: 100%; padding: 14px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;">\n          ✨ AI Rewrite Document (Demo)\n        </button>\n        <div id="rewrite-status" style="margin-top: 12px; text-align: center; color: #666; font-size: 14px;"></div>\n\n        \x3c!-- Progress Bar --\x3e\n        <div id="progress-container" style="display: none; margin-top: 16px;">\n          <div id="progress-text" style="font-size: 13px; color: #666; margin-bottom: 8px;">Processing...</div>\n          <div style="width: 100%; height: 8px; background: #f0f0f0; border-radius: 4px; overflow: hidden;">\n            <div id="progress-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); transition: width 0.3s ease;"></div>\n          </div>\n        </div>\n      </div>\n    </div>\n  ',"\n      ").concat('\n    <div id="checklist-tab" class="tab-content" style="display: none; flex: 1; background: white; padding: 20px; overflow: auto; flex-direction: column;">\n      <div style="max-width: 600px; width: 100%; margin: 0 auto;">\n        <h3 style="margin-bottom: 8px; color: #333;">✅ Document Checklist</h3>\n        <p style="font-size: 14px; color: #666; margin-bottom: 20px;">\n          Track your document completion progress\n        </p>\n\n        \x3c!-- Progress Bar --\x3e\n        <div style="margin-bottom: 24px;">\n          <div id="checklist-progress-text" style="font-size: 13px; color: #666; margin-bottom: 8px;">0 of 8 completed (0%)</div>\n          <div style="width: 100%; height: 12px; background: #f0f0f0; border-radius: 6px; overflow: hidden;">\n            <div id="checklist-progress-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); transition: width 0.3s ease;"></div>\n          </div>\n        </div>\n\n        \x3c!-- Action Buttons --\x3e\n        <div style="display: flex; gap: 8px; margin-bottom: 20px;">\n          <button id="auto-check-btn" style="flex: 1; padding: 10px; background: #667eea; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 14px;">\n            🔍 Auto-check Document\n          </button>\n          <button id="reset-checklist-btn" style="padding: 10px 16px; background: #f3f4f6; color: #666; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 14px;">\n            Reset\n          </button>\n        </div>\n\n        \x3c!-- Checklist Items --\x3e\n        <div id="checklist-items">\n          \x3c!-- Populated by JavaScript --\x3e\n        </div>\n      </div>\n    </div>\n  ',"\n      ").concat('\n    <div id="ai-chat-tab" class="tab-content" style="display: none; flex: 1; background: white; padding: 20px; flex-direction: column;">\n      <div style="text-align: center; color: #999; flex: 1; display: flex; align-items: center; justify-content: center; flex-direction: column;">\n        <div style="max-width: 400px;">\n          <h3 style="margin-bottom: 16px; color: #333;">💬 AI Chat</h3>\n          <p style="font-size: 14px; line-height: 1.6; margin-bottom: 24px;">\n            Chat with Kenneth AI about your document, ask questions, and get intelligent assistance.\n          </p>\n          <div style="padding: 16px; background: #f9f9f9; border-radius: 8px; border: 1px solid #e0e0e0;">\n            <p style="font-size: 13px; color: #666; margin: 0;">\n              🚧 Coming soon: Interactive AI chat interface\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  ',"\n    </div>\n  "),console.log("[Word] HTML injected successfully"),e=document.querySelectorAll(".tab-button"),t=document.querySelectorAll(".tab-content"),e.forEach(function(n){n.addEventListener("click",function(){var r=n.getAttribute("data-tab");e.forEach(function(e){e.classList.remove("active"),e.style.background="#1e1e1e",e.style.color="#999"}),t.forEach(function(e){e.classList.remove("active"),e.style.display="none"}),n.classList.add("active"),n.style.background="#2d2d2d",n.style.color="white";var o=document.getElementById("".concat(r,"-tab"));o&&(o.classList.add("active"),o.style.display="flex")})}),n=document.getElementById("ai-rewrite-btn"),r=document.getElementById("test-ping-btn"),n&&(n.onclick=d),r&&(r.onclick=D),console.log("[AI Chat] Tab initialized"),function(){G();var e=document.getElementById("reset-checklist-btn"),t=document.getElementById("auto-check-btn");e&&(e.onclick=W),t&&(t.onclick=N)}(),console.log("[Word] All tabs initialized")):console.error("[Word] app-container not found!")}}}]);
//# sourceMappingURL=word-main.js.map