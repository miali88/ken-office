/*! For license information please see word-main.js.LICENSE.txt */
"use strict";(self.webpackChunkkenneth_office_addin_unified=self.webpackChunkkenneth_office_addin_unified||[]).push([[71],{42689:function(e,t,n){n.r(t),n.d(t,{initialize:function(){return Z}});var o=[{type:"replaceText",target:"(years ending DD MM YYYY",value:"years ending 31 March 2024",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments",reasoning:"Financial year end dates extracted from company accounts filings"}},{type:"replacePlaceholder",target:"company_name",value:"ABERDEEN HOUSE CARE LIMITED",replaceAll:!0,metadata:{confidence:"high",source:"case details"}},{type:"replaceText",target:"….",value:"10 September 2025",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replaceText",target:"(introducer)",value:"[TO BE COMPLETED - Introducer Name]",metadata:{confidence:"low",source:"manual input"}},{type:"replaceText",target:"{{ CONDITION_1:",value:"",matchCase:!1,metadata:{confidence:"medium",source:"default assumption",reasoning:"Remove conditional marker"}},{type:"replaceText",target:"EITHER: Prior to this date, neither the firm nor the proposed Liquidators have had any other involvement with the Company or its Director. OR: Prior to this date, the proposed liquidators have had involvement with the director",value:"Prior to this date, neither the firm nor the proposed Liquidators have had any other involvement with the Company or its Director.",matchCase:!1,metadata:{confidence:"medium",source:"default assumption",reasoning:"Replace conditional options with chosen option"}},{type:"replaceText",target:"whether prior relationship has existed.",value:"",matchCase:!1,metadata:{confidence:"medium",source:"default assumption",reasoning:"Remove conditional description"}},{type:"replaceText",target:"}}",value:"",matchCase:!1,metadata:{confidence:"high",source:"template cleanup",reasoning:"Remove closing conditional brackets"}},{type:"replacePlaceholder",target:"{{our_firm_name}}",value:"Kenneth AI",replaceAll:!0,metadata:{confidence:"high",source:"case details"}},{type:"replacePlaceholder",target:"{{instruction_date}}",value:"10 September 2025",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{date_scheduled_for_s100}}",value:"13 September 2025",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{general_meeting_notice_date}}",value:"06 September 2025",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{general_meeting_datetime}}",value:"13 September 2025 at 10:00 AM",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{full_names_address_of_ip}}",value:"ABERDEEN HOUSE CARE LIMITED, 123 Fictional Lane, Anytown, AB1 2CD",replaceAll:!0,metadata:{confidence:"medium",source:"case details and searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{incorporation_date}}",value:"15 June 2011",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{company_reg_number}}",value:"07658860",replaceAll:!0,metadata:{confidence:"high",source:"case details"}},{type:"replacePlaceholder",target:"{{trading_address}}",value:"456 Business Road, Cityville, CV1 2EF",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{company_trading_activity}}",value:"Operating care homes",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"deleteText",target:"{{below table should be populated with list of previous registered addresses}}",metadata:{confidence:"high",reasoning:"Template instruction for table below"}},{type:"fillTableCell",tableIndex:0,row:1,cell:0,value:"15 June 2011",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:0,row:1,cell:1,value:"31 December 2023",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:0,row:1,cell:2,value:"789 Old Street, Townsville, TS1 2GH",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:0,row:2,cell:0,value:"01 January 2024",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:0,row:2,cell:1,value:"Current",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:0,row:2,cell:2,value:"Business Helpline Group Limited, 101 New Avenue, Metropolis, MT1 2IJ",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"replacePlaceholder",target:"{{equity_capital_structure}}",value:"is £100,000, comprising 100,000 Ordinary shares of £1 each",replaceAll:!0,metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"deleteText",target:"{{below table should list the name, shares and percentage of each shareholder}}",metadata:{confidence:"high",reasoning:"Template instruction for table below"}},{type:"fillTableCell",tableIndex:1,row:1,cell:0,value:"KOTECHA, Rakesh",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:1,row:1,cell:1,value:"50,000",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:1,row:1,cell:2,value:"50%",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:1,row:2,cell:0,value:"KOTECHA, Mahesh Vithaldas",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:1,row:2,cell:1,value:"50,000",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:1,row:2,cell:2,value:"50%",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"deleteText",target:"{{below table should list the schema for officers of the company}}",metadata:{confidence:"high",reasoning:"Template instruction for table below"}},{type:"fillTableCell",tableIndex:2,row:1,cell:0,value:"KOTECHA, Rakesh",metadata:{confidence:"high",source:"case details"}},{type:"fillTableCell",tableIndex:2,row:1,cell:1,value:"Director",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:1,cell:2,value:"15 June 2011",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:1,cell:3,value:"N/A",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:2,cell:0,value:"KOTECHA, Mahesh Vithaldas",metadata:{confidence:"high",source:"case details"}},{type:"fillTableCell",tableIndex:2,row:2,cell:1,value:"Director",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:2,cell:2,value:"15 June 2011",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:2,cell:3,value:"N/A",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:3,cell:0,value:"KOTECHA, Pragna",metadata:{confidence:"high",source:"case details"}},{type:"fillTableCell",tableIndex:2,row:3,cell:1,value:"Director",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:3,cell:2,value:"01 January 2015",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:3,cell:3,value:"N/A",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:4,cell:0,value:"KOTECHA, Trushali",metadata:{confidence:"high",source:"case details"}},{type:"fillTableCell",tableIndex:2,row:4,cell:1,value:"Director",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:4,cell:2,value:"01 January 2015",metadata:{confidence:"medium",source:"searchCaseDocuments"}},{type:"fillTableCell",tableIndex:2,row:4,cell:3,value:"N/A",metadata:{confidence:"medium",source:"searchCaseDocuments"}}];function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,c,i=[],s=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(o=a.call(n)).done)&&(i.push(o.value),i.length!==t);s=!0);}catch(e){l=!0,r=e}finally{try{if(!s&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(l)throw r}}return i}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=c(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function c(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function s(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function a(n,o,r,a){var s=o&&o.prototype instanceof i?o:i,d=Object.create(s.prototype);return l(d,"_invoke",function(n,o,r){var a,i,s,l=0,d=r||[],u=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return a=t,i=0,s=e,p.n=n,c}};function f(n,o){for(i=n,s=o,t=0;!u&&l&&!r&&t<d.length;t++){var r,a=d[t],f=p.p,m=a[2];n>3?(r=m===o)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=f&&((r=n<2&&f<a[1])?(i=0,p.v=o,p.n=a[1]):f<m&&(r=n<3||a[0]>o||o>m)&&(a[4]=n,a[5]=o,p.n=m,i=0))}if(r||n>1)return c;throw u=!0,o}return function(r,d,m){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&f(d,m),i=d,s=m;(t=i<2?e:s)||!u;){a||(i?i<3?(i>1&&(p.n=-1),f(i,s)):p.n=s:p.v=s);try{if(l=2,a){if(i||(r="next"),t=a[r]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),i=1);a=e}else if((t=(u=p.n<0)?s:n.call(o,p))!==c)break}catch(t){a=e,i=1,s=t}finally{l=1}}return{value:t,done:u}}}(n,r,a),!0),d}var c={};function i(){}function d(){}function u(){}t=Object.getPrototypeOf;var p=[][o]?t(t([][o]())):(l(t={},o,function(){return this}),t),f=u.prototype=i.prototype=Object.create(p);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,l(e,r,"GeneratorFunction")),e.prototype=Object.create(f),e}return d.prototype=u,l(f,"constructor",u),l(u,"constructor",d),d.displayName="GeneratorFunction",l(u,r,"GeneratorFunction"),l(f),l(f,r,"Generator"),l(f,o,function(){return this}),l(f,"toString",function(){return"[object Generator]"}),(s=function(){return{w:a,m:m}})()}function l(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}l=function(e,t,n,o){function a(t,n){l(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},l(e,t,n,o)}function d(e,t,n,o,r,a,c){try{var i=e[a](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(o,r)}function u(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var a=e.apply(t,n);function c(e){d(a,o,r,c,i,"next",e)}function i(e){d(a,o,r,c,i,"throw",e)}c(void 0)})}}function p(){return f.apply(this,arguments)}function f(){return f=u(s().m(function e(){var t,n,o,r,a,c,i,l,d,u,p,f,h,b,v,w,x,k;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=document.getElementById("rewrite-status"),n=document.getElementById("progress-container"),o=document.getElementById("progress-bar"),r=document.getElementById("progress-text"),a=document.getElementById("ai-rewrite-btn"),t&&a){e.n=1;break}return alert("Required UI elements not found"),e.a(2);case 1:return c=[],i=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=(new Date).toLocaleTimeString(),r="".concat(o," ").concat(e);c.push(r),console.log(r);var a=n?"#d32f2f":"#666";t.innerHTML='\n      <div style="padding: 12px; background: '.concat(n?"#ffebee":"#f5f5f5","; border-radius: 4px; border: 1px solid ").concat(n?"#ef5350":"#ddd",';">\n        <div style="margin-bottom: 8px; font-weight: bold; color: ').concat(a,';">').concat(e,'</div>\n        <div style="max-height: 200px; overflow-y: auto; font-size: 11px; font-family: monospace; background: white; padding: 8px; border-radius: 4px;">\n          ').concat(c.map(function(e){return'<div style="margin: 2px 0;">'.concat(e,"</div>")}).join(""),"\n        </div>\n      </div>\n    ")},e.p=2,a.disabled=!0,n&&(n.style.display="block"),i("📖 STEP 1/3: Extracting document text..."),r&&(r.textContent="Step 1/3: Reading document"),o&&(o.style.width="10%"),e.p=3,i("  Loading document body..."),e.n=4,m();case 4:l=e.v,i("  ✅ Extracted ".concat(l.text.length," chars, ").concat(l.placeholders.length," placeholders")),o&&(o.style.width="33%"),e.n=6;break;case 5:throw e.p=5,v=e.v,d=v instanceof Error?v.message:String(v),i("❌ EXTRACTION FAILED: ".concat(d),!0),new Error("Step 1 failed: ".concat(d));case 6:return i("🤖 STEP 2/3: Loading mock AI response..."),r&&(r.textContent="Step 2/3: AI processing (mock data)"),o&&(o.style.width="40%"),e.p=7,i("  Loading pre-configured operations..."),e.n=8,y(l,i);case 8:u=e.v,i("  ✅ Loaded ".concat(u.length," operations from mock data")),o&&(o.style.width="66%"),e.n=10;break;case 9:throw e.p=9,w=e.v,p=w instanceof Error?w.message:String(w),i("❌ MOCK DATA LOADING FAILED: ".concat(p),!0),new Error("Step 2 failed: ".concat(p));case 10:return i("✍️ STEP 3/3: Applying changes to document..."),r&&(r.textContent="Step 3/3: Applying changes"),o&&(o.style.width="75%"),e.p=11,e.n=12,g(u);case 12:i("  ✅ Applied all ".concat(u.length," operations")),o&&(o.style.width="100%"),e.n=14;break;case 13:throw e.p=13,x=e.v,f=x instanceof Error?x.message:String(x),i("❌ EXECUTION FAILED: ".concat(f),!0),new Error("Step 3 failed: ".concat(f));case 14:t.innerHTML='\n      <div style="padding: 12px; background: #e8f5e9; border: 2px solid #4caf50; border-radius: 4px;">\n        <div style="color: #2e7d32; font-weight: bold; margin-bottom: 8px;">✅ Document updated successfully!</div>\n        <div style="max-height: 200px; overflow-y: auto; font-size: 11px; font-family: monospace; background: white; padding: 8px; border-radius: 4px;">\n          '.concat(c.map(function(e){return'<div style="margin: 2px 0;">'.concat(e,"</div>")}).join(""),"\n        </div>\n      </div>\n    "),r&&(r.textContent="Complete!"),setTimeout(function(){n&&(n.style.display="none")},3e3),e.n=16;break;case 15:e.p=15,k=e.v,console.error("[FATAL ERROR]",k),h=k instanceof Error?k.message:String(k),b=k instanceof Error?k.stack:"",t.innerHTML='\n      <div style="padding: 12px; background: #ffebee; border: 2px solid #d32f2f; border-radius: 4px;">\n        <div style="color: #d32f2f; font-weight: bold; margin-bottom: 8px; font-size: 16px;">❌ PROCESS FAILED</div>\n        <div style="margin-bottom: 12px; color: #333; font-size: 14px;">'.concat(h,'</div>\n        <div style="margin-bottom: 12px; max-height: 200px; overflow-y: auto; font-size: 11px; font-family: monospace; background: white; padding: 8px; border-radius: 4px;">\n          ').concat(c.map(function(e){return'<div style="margin: 2px 0;">'.concat(e,"</div>")}).join(""),'\n        </div>\n        <details style="margin-top: 8px;">\n          <summary style="cursor: pointer; color: #d32f2f; font-size: 12px;">Show stack trace</summary>\n          <pre style="font-size: 10px; margin-top: 4px; background: #f5f5f5; padding: 8px; border-radius: 4px; overflow-x: auto; white-space: pre-wrap;">').concat(b||"No stack trace available","</pre>\n        </details>\n      </div>\n    "),r&&(r.textContent="FAILED",r.style.color="#d32f2f"),o&&(o.style.background="#d32f2f");case 16:return e.p=16,a.disabled=!1,e.f(16);case 17:return e.a(2)}},e,null,[[11,13],[7,9],[3,5],[2,15,16,17]])})),f.apply(this,arguments)}function m(){return h.apply(this,arguments)}function h(){return h=u(s().m(function e(){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Word.run(function(){var e=u(s().m(function e(t){var n,o,r,a;return s().w(function(e){for(;;)switch(e.n){case 0:return(n=t.document.body).load("text"),e.n=1,t.sync();case 1:return o=n.text,r=/\{\{[^}]+\}\}/g,a=Array.from(new Set(o.match(r)||[])),e.a(2,{text:o,tables:[],placeholders:a})}},e)}));return function(t){return e.apply(this,arguments)}}()))},e)})),h.apply(this,arguments)}function y(e,t){return b.apply(this,arguments)}function b(){return(b=u(s().m(function e(t,n){return s().w(function(e){for(;;)switch(e.n){case 0:return n("  📦 Using hardcoded mock data (no backend required)"),e.n=1,new Promise(function(e){return setTimeout(e,800)});case 1:return n("  ✅ Mock data contains ".concat(o.length," operations")),n("  ℹ️  This is DEMO MODE - edit mockLLMResponse.ts to change operations"),e.a(2,o)}},e)}))).apply(this,arguments)}function g(e){return v.apply(this,arguments)}function v(){return v=u(s().m(function e(t){return s().w(function(e){for(;;)if(0===e.n)return e.a(2,Word.run(function(){var e=u(s().m(function e(n){var o,c,i,l,d,u,p,f,m,h,y,b,g,v,x,C,I,E,S;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:console.log("[Operations] Starting execution, count:",t.length),n.document.changeTrackingMode=Word.ChangeTrackingMode.trackAll;try{n.document.properties.author="Kenneth AI",n.document.properties.load("author")}catch(e){console.warn("Could not set author:",e)}return e.n=1,n.sync();case 1:o=0,c=0,i=new Map,l=[],d=a(t);try{for(d.s();!(u=d.n()).done;)"fillTableCell"===(p=u.value).type?((f=i.get(p.tableIndex)||[]).push(p),i.set(p.tableIndex,f)):l.push(p)}catch(e){d.e(e)}finally{d.f()}m=Array.from(i.entries()),h=0,y=m;case 2:if(!(h<y.length)){e.n=8;break}return b=r(y[h],2),g=b[0],v=b[1],console.log("[Table ".concat(g,"] Processing ").concat(v.length," cell operations")),e.p=3,e.n=4,w(n,g,v);case 4:return e.n=5,n.sync();case 5:o+=v.length,e.n=7;break;case 6:e.p=6,I=e.v,c+=v.length,console.error("Table ".concat(g," operations failed:"),I);case 7:h++,e.n=2;break;case 8:x=0;case 9:if(!(x<l.length)){e.n=22;break}C=l[x],console.log("[Operation ".concat(x+1,"/").concat(l.length,"] Type: ").concat(C.type)),e.p=10,E=C.type,e.n="replacePlaceholder"===E?11:"replaceText"===E?13:"deleteText"===E?15:17;break;case 11:return e.n=12,k(n,C);case 12:return e.a(3,18);case 13:return e.n=14,T(n,C);case 14:return e.a(3,18);case 15:return e.n=16,A(n,C);case 16:return e.a(3,18);case 17:return console.warn("Unknown operation type:",C),c++,e.a(3,21);case 18:return e.n=19,n.sync();case 19:o++,e.n=21;break;case 20:e.p=20,S=e.v,c++,console.error("Operation ".concat(x," failed:"),S);case 21:x++,e.n=9;break;case 22:console.log("[Operations] Complete:",{total:t.length,success:o,failed:c});case 23:return e.a(2)}},e,null,[[10,20],[3,6]])}));return function(t){return e.apply(this,arguments)}}()))},e)})),v.apply(this,arguments)}function w(e,t,n){return x.apply(this,arguments)}function x(){return(x=u(s().m(function e(t,n,o){var r,c,i,l,d,u,p,f,m,h,y,b,g,v,w,x,k,C;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return(r=t.document.body.tables).load("items"),e.n=1,t.sync();case 1:if(!(n>=r.items.length)){e.n=2;break}return console.warn("Table ".concat(n," not found")),e.a(2);case 2:return c=r.items[n],(i=c.rows).load("items"),e.n=3,t.sync();case 3:l=[],d=a(o),e.p=4,d.s();case 5:if((u=d.n()).done){e.n=10;break}if(!((p=u.value).row>=i.items.length)){e.n=6;break}return console.warn("Row ".concat(p.row," not found in table ").concat(n)),e.a(3,9);case 6:return f=i.items[p.row],(m=f.cells).load("items"),e.n=7,t.sync();case 7:if(!(p.cell>=m.items.length)){e.n=8;break}return console.warn("Cell ".concat(p.cell," not found in row ").concat(p.row)),e.a(3,9);case 8:(h=m.items[p.cell]).body.clear(),h.body.insertText(p.value,Word.InsertLocation.start),l.push({row:p.row,cell:p.cell,value:p.value});case 9:e.n=5;break;case 10:e.n=12;break;case 11:e.p=11,k=e.v,d.e(k);case 12:return e.p=12,d.f(),e.f(12);case 13:if(!(l.length>0&&o.length>0)){e.n=17;break}return e.p=14,y=o[0],b=i.items[y.row],(g=b.cells).load("items"),e.n=15,t.sync();case 15:v=g.items[y.cell],w=v.body.getRange(),x=D(n,l,o[0].metadata),w.insertComment(x),console.log("Added single comment to table ".concat(n," summarizing ").concat(l.length," cell changes")),e.n=17;break;case 16:e.p=16,C=e.v,console.warn("Could not add comment to table:",C);case 17:return e.a(2)}},e,null,[[14,16],[4,11,12,13]])}))).apply(this,arguments)}function k(e,t){return C.apply(this,arguments)}function C(){return(C=u(s().m(function e(t,n){var o,r,c,i,l,d,u,p,f,m,h,y,b,g,v,w,x,k,C,T,I;return s().w(function(e){for(;;)switch(e.p=e.n){case 0:return o=n.target.length>200,r=n.target,o&&(c=n.target.match(/^(\{\{[\s]*[A-Z_0-9]+[\s]*:)/),r=c?c[1]:n.target.substring(0,100)),(i=t.document.body.search(r,{matchCase:!1,matchWholeWord:!1})).load("items"),e.n=1,t.sync();case 1:if(0!==i.items.length){e.n=2;break}return console.warn("Placeholder not found: ".concat(r)),e.a(2);case 2:if(l=0,d=S("replacePlaceholder",n.value,n.metadata,n.target),!o){e.n=14;break}u=a(i.items),e.p=3,u.s();case 4:if((p=u.n()).done){e.n=10;break}return f=p.value,e.p=5,(m=f.paragraphs.getFirst()).load("text"),e.n=6,t.sync();case 6:if(h=m.text,-1===(y=h.indexOf(n.target))){e.n=7;break}b=h.substring(0,y)+n.value+h.substring(y+n.target.length),m.clear(),g=m.insertText(b,Word.InsertLocation.start);try{g.insertComment(d)}catch(e){console.warn("Could not add comment:",e)}if(l++,!1!==n.replaceAll){e.n=7;break}return e.a(3,10);case 7:e.n=9;break;case 8:e.p=8,e.v,v=f.insertText(n.value,Word.InsertLocation.replace);try{v.insertComment(d)}catch(e){console.warn("Could not add comment:",e)}if(l++,!1!==n.replaceAll){e.n=9;break}return e.a(3,10);case 9:e.n=4;break;case 10:e.n=12;break;case 11:e.p=11,I=e.v,u.e(I);case 12:return e.p=12,u.f(),e.f(12);case 13:e.n=15;break;case 14:if(!1!==n.replaceAll){w=a(i.items);try{for(w.s();!(x=w.n()).done;){k=x.value,C=k.insertText(n.value,Word.InsertLocation.replace);try{C.insertComment(d)}catch(e){console.warn("Could not add comment:",e)}l++}}catch(e){w.e(e)}finally{w.f()}}else{T=i.items[0].insertText(n.value,Word.InsertLocation.replace);try{T.insertComment(d)}catch(e){console.warn("Could not add comment:",e)}l=1}case 15:console.log("Replaced ".concat(l," occurrences"));case 16:return e.a(2)}},e,null,[[5,8],[3,11,12,13]])}))).apply(this,arguments)}function T(e,t){return I.apply(this,arguments)}function I(){return(I=u(s().m(function e(t,n){var o,r,c,i,l,d;return s().w(function(e){for(;;)switch(e.n){case 0:return(o=t.document.body.search(n.target,{matchCase:n.matchCase||!1,matchWholeWord:n.matchWholeWord||!1})).load("items"),e.n=1,t.sync();case 1:if(0!==o.items.length){e.n=2;break}return console.warn("Text not found: ".concat(n.target)),e.a(2);case 2:r=S("replaceText",n.value,n.metadata,n.target),c=a(o.items);try{for(c.s();!(i=c.n()).done;){l=i.value,d=l.insertText(n.value,Word.InsertLocation.replace);try{d.insertComment(r)}catch(e){console.warn("Could not add comment:",e)}}}catch(e){c.e(e)}finally{c.f()}case 3:return e.a(2)}},e)}))).apply(this,arguments)}function A(e,t){return E.apply(this,arguments)}function E(){return(E=u(s().m(function e(t,n){var o,r,c;return s().w(function(e){for(;;)switch(e.n){case 0:return(o=t.document.body.search(n.target,{matchCase:!1,matchWholeWord:!1})).load("items"),e.n=1,t.sync();case 1:if(0!==o.items.length){e.n=2;break}return console.warn("Text not found: ".concat(n.target)),e.a(2);case 2:r=a(o.items);try{for(r.s();!(c=r.n()).done;)c.value.delete()}catch(e){r.e(e)}finally{r.f()}case 3:return e.a(2)}},e)}))).apply(this,arguments)}function S(e,t,n,o){var r=[];if(r.push("🤖 Kenneth AI - ".concat(e)),r.push(""),o){var a=o.length>100?o.substring(0,100)+"...":o;r.push('Replaced: "'.concat(a,'"')),r.push("")}var c=t.length>150?t.substring(0,150)+"...":t;if(r.push('New value: "'.concat(c,'"')),r.push(""),n){if(r.push("--- Metadata ---"),n.confidence){var i="high"===n.confidence?"✅":"medium"===n.confidence?"⚠️":"❓";r.push("".concat(i," Confidence: ").concat(n.confidence))}n.source&&r.push("📁 Source: ".concat(n.source)),n.reasoning&&r.push("💭 Reasoning: ".concat(n.reasoning)),r.push("")}return r.push("---"),r.push("Author: Kenneth AI (Demo Mode)"),r.push("💡 Using mock data from mockLLMResponse.ts"),r.join("\n")}function D(e,t,n){var o=[];o.push("🤖 Kenneth AI - fillTableCell"),o.push(""),o.push("Updated ".concat(t.length," cells in table ").concat(e)),o.push("");for(var r=Math.min(3,t.length),a=0;a<r;a++){var c=t[a],i=c.value.length>50?c.value.substring(0,50)+"...":c.value;o.push("  Row ".concat(c.row,", Cell ").concat(c.cell,': "').concat(i,'"'))}if(t.length>r&&o.push("  ... and ".concat(t.length-r," more cells")),o.push(""),n){if(o.push("--- Metadata ---"),n.confidence){var s="high"===n.confidence?"✅":"medium"===n.confidence?"⚠️":"❓";o.push("".concat(s," Confidence: ").concat(n.confidence))}n.source&&o.push("📁 Source: ".concat(n.source)),n.reasoning&&o.push("💭 Reasoning: ".concat(n.reasoning)),o.push("")}return o.push("---"),o.push("Author: Kenneth AI (Demo Mode)"),o.push("💡 Using mock data from mockLLMResponse.ts"),o.join("\n")}function O(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function a(n,o,r,a){var s=o&&o.prototype instanceof i?o:i,l=Object.create(s.prototype);return M(l,"_invoke",function(n,o,r){var a,i,s,l=0,d=r||[],u=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return a=t,i=0,s=e,p.n=n,c}};function f(n,o){for(i=n,s=o,t=0;!u&&l&&!r&&t<d.length;t++){var r,a=d[t],f=p.p,m=a[2];n>3?(r=m===o)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=f&&((r=n<2&&f<a[1])?(i=0,p.v=o,p.n=a[1]):f<m&&(r=n<3||a[0]>o||o>m)&&(a[4]=n,a[5]=o,p.n=m,i=0))}if(r||n>1)return c;throw u=!0,o}return function(r,d,m){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&f(d,m),i=d,s=m;(t=i<2?e:s)||!u;){a||(i?i<3?(i>1&&(p.n=-1),f(i,s)):p.n=s:p.v=s);try{if(l=2,a){if(i||(r="next"),t=a[r]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),i=1);a=e}else if((t=(u=p.n<0)?s:n.call(o,p))!==c)break}catch(t){a=e,i=1,s=t}finally{l=1}}return{value:t,done:u}}}(n,r,a),!0),l}var c={};function i(){}function s(){}function l(){}t=Object.getPrototypeOf;var d=[][o]?t(t([][o]())):(M(t={},o,function(){return this}),t),u=l.prototype=i.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,M(e,r,"GeneratorFunction")),e.prototype=Object.create(u),e}return s.prototype=l,M(u,"constructor",l),M(l,"constructor",s),s.displayName="GeneratorFunction",M(l,r,"GeneratorFunction"),M(u),M(u,r,"Generator"),M(u,o,function(){return this}),M(u,"toString",function(){return"[object Generator]"}),(O=function(){return{w:a,m:p}})()}function M(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}M=function(e,t,n,o){function a(t,n){M(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},M(e,t,n,o)}function L(e,t,n,o,r,a,c){try{var i=e[a](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(o,r)}function P(){return R.apply(this,arguments)}function R(){var e;return e=O().m(function e(){var t,n,o,r,a;return O().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=document.getElementById("test-result"),n=document.getElementById("test-ping-btn"),t&&n){e.n=1;break}return e.a(2);case 1:return n.disabled=!0,t.textContent="Running comprehensive diagnostics...\n\n",t.textContent+="TEST 1: Basic fetch capability\n",e.p=2,e.n=3,fetch("https://jsonplaceholder.typicode.com/todos/1");case 3:return o=e.v,e.n=4,o.json();case 4:r=e.v,t.textContent+="✅ Fetch works! Got external data: ".concat(r.title,"\n\n"),e.n=6;break;case 5:return e.p=5,a=e.v,t.textContent+="❌ Fetch completely blocked: ".concat(a instanceof Error?a.message:"Unknown","\n"),n.disabled=!1,e.a(2);case 6:t.textContent+="\n\nTEST 2: Environment info\n",t.textContent+="Current origin: ".concat(window.location.origin,"\n"),t.textContent+="Current URL: ".concat(window.location.href,"\n"),t.textContent+="Protocol: ".concat(window.location.protocol,"\n"),n.disabled=!1;case 7:return e.a(2)}},e,null,[[2,5]])}),R=function(){var t=this,n=arguments;return new Promise(function(o,r){var a=e.apply(t,n);function c(e){L(a,o,r,c,i,"next",e)}function i(e){L(a,o,r,c,i,"throw",e)}c(void 0)})},R.apply(this,arguments)}function _(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function a(n,o,r,a){var s=o&&o.prototype instanceof i?o:i,l=Object.create(s.prototype);return j(l,"_invoke",function(n,o,r){var a,i,s,l=0,d=r||[],u=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return a=t,i=0,s=e,p.n=n,c}};function f(n,o){for(i=n,s=o,t=0;!u&&l&&!r&&t<d.length;t++){var r,a=d[t],f=p.p,m=a[2];n>3?(r=m===o)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=f&&((r=n<2&&f<a[1])?(i=0,p.v=o,p.n=a[1]):f<m&&(r=n<3||a[0]>o||o>m)&&(a[4]=n,a[5]=o,p.n=m,i=0))}if(r||n>1)return c;throw u=!0,o}return function(r,d,m){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&f(d,m),i=d,s=m;(t=i<2?e:s)||!u;){a||(i?i<3?(i>1&&(p.n=-1),f(i,s)):p.n=s:p.v=s);try{if(l=2,a){if(i||(r="next"),t=a[r]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),i=1);a=e}else if((t=(u=p.n<0)?s:n.call(o,p))!==c)break}catch(t){a=e,i=1,s=t}finally{l=1}}return{value:t,done:u}}}(n,r,a),!0),l}var c={};function i(){}function s(){}function l(){}t=Object.getPrototypeOf;var d=[][o]?t(t([][o]())):(j(t={},o,function(){return this}),t),u=l.prototype=i.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,j(e,r,"GeneratorFunction")),e.prototype=Object.create(u),e}return s.prototype=l,j(u,"constructor",l),j(l,"constructor",s),s.displayName="GeneratorFunction",j(l,r,"GeneratorFunction"),j(u),j(u,r,"Generator"),j(u,o,function(){return this}),j(u,"toString",function(){return"[object Generator]"}),(_=function(){return{w:a,m:p}})()}function j(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}j=function(e,t,n,o){function a(t,n){j(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},j(e,t,n,o)}function z(e,t,n,o,r,a,c){try{var i=e[a](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(o,r)}function F(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var a=e.apply(t,n);function c(e){z(a,o,r,c,i,"next",e)}function i(e){z(a,o,r,c,i,"throw",e)}c(void 0)})}}function H(e){"https://localhost:3001"===e.origin&&console.log("[AI Chat] Message from chat widget:",e.data)}var B=[{type:"fillChecklistCell",tableIndex:0,row:1,cell:4,value:"MA\n16/10/2025",checklistMetadata:{status:"✅ Completed",commentary:"Based on review of company filings (CVL102.pdf), notice was sent on 06 September 2025 to all qualifying floating charge holders. The required 5 business day period has elapsed as of 13 September 2025.",references:["CVL102.pdf (QFCH Notice dated 06/09/2025)","Case Timeline Document","Companies House filing dated 06/09/2025"]}},{type:"fillChecklistCell",tableIndex:0,row:2,cell:4,value:"MA\n16/10/2025",checklistMetadata:{status:"✅ Completed",commentary:"Conducted comprehensive review of shareholder register and Companies House filings. No restriction notices found. Both shareholders (Rakesh Kotecha and Mahesh Kotecha) hold 50% each and have confirmed ability to exercise voting rights without restrictions.",references:["Shareholder Register (current)","Companies House PSC Register","Director confirmation emails dated 10/09/2025"]}},{type:"fillChecklistCell",tableIndex:0,row:3,cell:4,value:"MA\n16/10/2025",checklistMetadata:{status:"✅ Completed",commentary:"Members' resolution to wind up passed on 13 September 2025 at 10:00 AM. Creditors' decision date scheduled for 27 September 2025 (14 days after members' resolution), which complies with the statutory requirement.",references:["Members' Resolution dated 13/09/2025","Creditors' Decision Notice dated 13/09/2025","s84(2A) Insolvency Act 1986"]}},{type:"fillChecklistCell",tableIndex:0,row:4,cell:4,value:"MA\n16/10/2025",checklistMetadata:{status:"✅ Completed",commentary:"Statement of Affairs verified by director Rakesh Kotecha on 12 September 2025 with statement of truth. SoA made up to date of 05 September 2025 (8 days before winding-up resolution). Copy delivered to creditors on 26 September 2025, one business day before creditors' decision date of 27 September 2025. All timing requirements under R6.14(7) and s99 satisfied.",references:["Verified SoA dated 05/09/2025","Director's Statement of Truth (R. Kotecha) dated 12/09/2025","Creditor distribution records dated 26/09/2025","R6.14(7) and s99 Insolvency Act 1986"]}},{type:"fillChecklistCell",tableIndex:0,row:5,cell:4,value:"MA\n16/10/2025",checklistMetadata:{status:"✅ Completed",commentary:"Directors' meeting held on 11 September 2025 to review and approve draft SoA and deficiency account. SoA verified by Rakesh Kotecha (statement of truth). Mahesh Kotecha, Pragna Kotecha, and Trushali Kotecha submitted statements of concurrence. Directors were advised of penalties for false statements per s235 Insolvency Act 1986. Minutes signed by chairman R. Kotecha. All schedules prepared including employee claims schedule (3 employees, total £45,200) and consumer creditors schedule (none identified). HMRC secondary preferential status correctly reflected for VAT and PAYE owed since December 2020.",references:["Directors' Meeting Minutes dated 11/09/2025","CVL301-F (Statement of Affairs)","Employee Claims Schedule (3 employees)","Director Statements of Concurrence (M. Kotecha, P. Kotecha, T. Kotecha)","s235 Insolvency Act 1986","Insolvency Act 1986 (HMRC Debts: Priority on Insolvency) Regulations 2020"]}},{type:"fillChecklistCell",tableIndex:0,row:6,cell:4,value:"N/A",checklistMetadata:{status:"⚠️ Not Required",commentary:"No application to court for limited disclosure has been made. The liquidator has determined that full disclosure of the Statement of Affairs does not prejudice the conduct of the liquidation and is not reasonably expected to lead to violence against any person. Standard full disclosure procedures apply.",references:["Liquidator's disclosure assessment dated 12/09/2025","R6.6 Insolvency Rules 2016"]}}];function G(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function a(n,o,r,a){var s=o&&o.prototype instanceof i?o:i,l=Object.create(s.prototype);return W(l,"_invoke",function(n,o,r){var a,i,s,l=0,d=r||[],u=!1,p={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return a=t,i=0,s=e,p.n=n,c}};function f(n,o){for(i=n,s=o,t=0;!u&&l&&!r&&t<d.length;t++){var r,a=d[t],f=p.p,m=a[2];n>3?(r=m===o)&&(s=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=f&&((r=n<2&&f<a[1])?(i=0,p.v=o,p.n=a[1]):f<m&&(r=n<3||a[0]>o||o>m)&&(a[4]=n,a[5]=o,p.n=m,i=0))}if(r||n>1)return c;throw u=!0,o}return function(r,d,m){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&f(d,m),i=d,s=m;(t=i<2?e:s)||!u;){a||(i?i<3?(i>1&&(p.n=-1),f(i,s)):p.n=s:p.v=s);try{if(l=2,a){if(i||(r="next"),t=a[r]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),i=1);a=e}else if((t=(u=p.n<0)?s:n.call(o,p))!==c)break}catch(t){a=e,i=1,s=t}finally{l=1}}return{value:t,done:u}}}(n,r,a),!0),l}var c={};function i(){}function s(){}function l(){}t=Object.getPrototypeOf;var d=[][o]?t(t([][o]())):(W(t={},o,function(){return this}),t),u=l.prototype=i.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,W(e,r,"GeneratorFunction")),e.prototype=Object.create(u),e}return s.prototype=l,W(u,"constructor",l),W(l,"constructor",s),s.displayName="GeneratorFunction",W(l,r,"GeneratorFunction"),W(u),W(u,r,"Generator"),W(u,o,function(){return this}),W(u,"toString",function(){return"[object Generator]"}),(G=function(){return{w:a,m:p}})()}function W(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}W=function(e,t,n,o){function a(t,n){W(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},W(e,t,n,o)}function K(e,t,n,o,r,a,c){try{var i=e[a](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(o,r)}function N(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var a=e.apply(t,n);function c(e){K(a,o,r,c,i,"next",e)}function i(e){K(a,o,r,c,i,"throw",e)}c(void 0)})}}function U(){return q.apply(this,arguments)}function q(){return q=N(G().m(function e(){var t,n,o,r,a,c,i,s,l,d;return G().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=document.getElementById("checklist-status"),n=document.getElementById("auto-review-checklist-btn"),o=document.getElementById("checklist-progress-container"),r=document.getElementById("checklist-progress-bar"),a=document.getElementById("checklist-progress-text"),t&&n){e.n=1;break}return alert("Required UI elements not found"),e.a(2);case 1:return c=[],i=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=(new Date).toLocaleTimeString(),r="".concat(o," ").concat(e);c.push(r),console.log(r);var a=n?"#d32f2f":"#666";t.innerHTML='\n      <div style="padding: 12px; background: '.concat(n?"#ffebee":"#f5f5f5","; border-radius: 4px; border: 1px solid ").concat(n?"#ef5350":"#ddd",';">\n        <div style="margin-bottom: 8px; font-weight: bold; color: ').concat(a,';">').concat(e,'</div>\n        <div style="max-height: 200px; overflow-y: auto; font-size: 11px; font-family: monospace; background: white; padding: 8px; border-radius: 4px;">\n          ').concat(c.map(function(e){return'<div style="margin: 2px 0;">'.concat(e,"</div>")}).join(""),"\n        </div>\n      </div>\n    ")},e.p=2,n.disabled=!0,o&&(o.style.display="block"),i("🔍 Starting checklist auto-review..."),a&&(a.textContent="Analyzing checklist table..."),r&&(r.style.width="10%"),i("📦 Loading ".concat(B.length," checklist review operations...")),r&&(r.style.width="25%"),i("✍️ Populating checklist with review data..."),a&&(a.textContent="Filling checklist cells..."),r&&(r.style.width="50%"),e.n=3,J(B,function(e){r&&(r.style.width="".concat(50+40*e,"%")),i("  ✓ Completed operation ".concat(Math.floor(e*B.length),"/").concat(B.length))});case 3:r&&(r.style.width="100%"),i("✅ Successfully populated ".concat(B.length," checklist items!")),t.innerHTML='\n      <div style="padding: 12px; background: #e8f5e9; border: 2px solid #4caf50; border-radius: 4px;">\n        <div style="color: #2e7d32; font-weight: bold; margin-bottom: 8px;">✅ Checklist auto-review complete!</div>\n        <div style="font-size: 13px; color: #1b5e20; margin-bottom: 8px;">\n          Populated '.concat(B.length,' items with initials and review comments\n        </div>\n        <div style="max-height: 200px; overflow-y: auto; font-size: 11px; font-family: monospace; background: white; padding: 8px; border-radius: 4px;">\n          ').concat(c.map(function(e){return'<div style="margin: 2px 0;">'.concat(e,"</div>")}).join(""),"\n        </div>\n      </div>\n    "),a&&(a.textContent="Complete!"),setTimeout(function(){o&&(o.style.display="none")},3e3),e.n=5;break;case 4:e.p=4,d=e.v,console.error("[FATAL ERROR]",d),s=d instanceof Error?d.message:String(d),l=d instanceof Error?d.stack:"",t.innerHTML='\n      <div style="padding: 12px; background: #ffebee; border: 2px solid #d32f2f; border-radius: 4px;">\n        <div style="color: #d32f2f; font-weight: bold; margin-bottom: 8px; font-size: 16px;">❌ AUTO-REVIEW FAILED</div>\n        <div style="margin-bottom: 12px; color: #333; font-size: 14px;">'.concat(s,'</div>\n        <div style="margin-bottom: 12px; max-height: 200px; overflow-y: auto; font-size: 11px; font-family: monospace; background: white; padding: 8px; border-radius: 4px;">\n          ').concat(c.map(function(e){return'<div style="margin: 2px 0;">'.concat(e,"</div>")}).join(""),'\n        </div>\n        <details style="margin-top: 8px;">\n          <summary style="cursor: pointer; color: #d32f2f; font-size: 12px;">Show stack trace</summary>\n          <pre style="font-size: 10px; margin-top: 4px; background: #f5f5f5; padding: 8px; border-radius: 4px; overflow-x: auto; white-space: pre-wrap;">').concat(l||"No stack trace available","</pre>\n        </details>\n      </div>\n    "),a&&(a.textContent="FAILED",a.style.color="#d32f2f"),r&&(r.style.background="#d32f2f");case 5:return e.p=5,n.disabled=!1,e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])})),q.apply(this,arguments)}function J(e,t){return V.apply(this,arguments)}function V(){return V=N(G().m(function e(t,n){return G().w(function(e){for(;;)if(0===e.n)return e.a(2,Word.run(function(){var e=N(G().m(function e(o){var r,a,c,i,s;return G().w(function(e){for(;;)switch(e.p=e.n){case 0:console.log("[Checklist] Starting execution, count:",t.length),o.document.changeTrackingMode=Word.ChangeTrackingMode.trackAll;try{o.document.properties.author="Kenneth AI",o.document.properties.load("author")}catch(e){console.warn("Could not set author:",e)}return e.n=1,o.sync();case 1:r=0,a=0,c=0;case 2:if(!(c<t.length)){e.n=8;break}return i=t[c],console.log("[Operation ".concat(c+1,"/").concat(t.length,"] Filling checklist cell at row ").concat(i.row)),e.p=3,e.n=4,X(o,i);case 4:return e.n=5,o.sync();case 5:r++,n&&n((c+1)/t.length),e.n=7;break;case 6:e.p=6,s=e.v,a++,console.error("Operation ".concat(c," failed:"),s);case 7:c++,e.n=2;break;case 8:console.log("[Checklist] Complete:",{total:t.length,success:r,failed:a});case 9:return e.a(2)}},e,null,[[3,6]])}));return function(t){return e.apply(this,arguments)}}()))},e)})),V.apply(this,arguments)}function X(e,t){return Y.apply(this,arguments)}function Y(){return(Y=N(G().m(function e(t,n){var o,r,a,c,i,s,l,d;return G().w(function(e){for(;;)switch(e.n){case 0:return(o=t.document.body.tables).load("items"),e.n=1,t.sync();case 1:if(!(n.tableIndex>=o.items.length)){e.n=2;break}return console.warn("Table ".concat(n.tableIndex," not found")),e.a(2);case 2:return r=o.items[n.tableIndex],(a=r.rows).load("items"),e.n=3,t.sync();case 3:if(!(n.row>=a.items.length)){e.n=4;break}return console.warn("Row ".concat(n.row," not found")),e.a(2);case 4:return c=a.items[n.row],(i=c.cells).load("items"),e.n=5,t.sync();case 5:if(!(n.cell>=i.items.length)){e.n=6;break}return console.warn("Cell ".concat(n.cell," not found")),e.a(2);case 6:(s=i.items[n.cell]).body.clear(),l=s.body.insertText(n.value,Word.InsertLocation.start);try{d=Q(n),l.insertComment(d),console.log("Comment added successfully to cell:",n.row,n.cell)}catch(e){console.warn("Could not add comment to checklist cell:",e)}case 7:return e.a(2)}},e)}))).apply(this,arguments)}function Q(e){var t=[],n=e.checklistMetadata;return t.push("Status: ".concat(n.status)),t.push(""),t.push("Commentary:"),t.push(n.commentary),t.push(""),n.references&&n.references.length>0&&(t.push("References:"),n.references.forEach(function(e){t.push("  • ".concat(e))}),t.push("")),t.push("---"),t.push("Generated by Kenneth AI (Demo Mode)"),t.join("\n")}function Z(){console.log("[Word] Initializing Word add-in...");var e,t,n,o,r,a=document.getElementById("app-container");a?(a.innerHTML='\n    <div style="width: 100%; height: 100vh; display: flex; flex-direction: column; background: white; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif;">\n      \x3c!-- Tab Navigation --\x3e\n      <div style="display: flex; background: #1e1e1e; border-bottom: 1px solid #666;">\n        <button class="tab-button active" data-tab="drafting" style="flex: 1; padding: 12px; background: #2d2d2d; color: white; border: none; cursor: pointer; font-weight: 600;">Drafting</button>\n        <button class="tab-button" data-tab="checklist" style="flex: 1; padding: 12px; background: #1e1e1e; color: #999; border: none; cursor: pointer; font-weight: 600;">Checklist</button>\n        <button class="tab-button" data-tab="ai-chat" style="flex: 1; padding: 12px; background: #1e1e1e; color: #999; border: none; cursor: pointer; font-weight: 600;">AI Chat</button>\n      </div>\n\n      \x3c!-- Tab Content Areas --\x3e\n      '.concat('\n    <div id="drafting-tab" class="tab-content active" style="display: flex; flex: 1; background: white; padding: 20px; overflow: auto; flex-direction: column; align-items: center; justify-content: flex-start;">\n      \x3c!-- DEBUG: Test Backend Connection --\x3e\n\n      \x3c!-- AI Rewrite Section --\x3e\n      <div style="width: 100%; max-width: 500px; margin-bottom: 30px;">\n        <h3 style="margin-bottom: 12px; color: #333;">🤖 AI Document Rewrite (Demo Mode)</h3>\n        <p style="font-size: 14px; color: #666; margin-bottom: 8px;">\n          Fill placeholders and tables using mock AI operations (no backend required)\n        </p>\n        <p style="font-size: 12px; color: #999; margin-bottom: 16px; padding: 8px; background: #f9f9f9; border-radius: 4px; border-left: 3px solid #667eea;">\n          💡 This demo uses hardcoded data from <code>mockLLMResponse.ts</code>\n        </p>\n        <button id="ai-rewrite-btn" style="width: 100%; padding: 14px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;">\n          ✨ AI Rewrite Document (Demo)\n        </button>\n        <div id="rewrite-status" style="margin-top: 12px; text-align: center; color: #666; font-size: 14px;"></div>\n\n        \x3c!-- Progress Bar --\x3e\n        <div id="progress-container" style="display: none; margin-top: 16px;">\n          <div id="progress-text" style="font-size: 13px; color: #666; margin-bottom: 8px;">Processing...</div>\n          <div style="width: 100%; height: 8px; background: #f0f0f0; border-radius: 4px; overflow: hidden;">\n            <div id="progress-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); transition: width 0.3s ease;"></div>\n          </div>\n        </div>\n      </div>\n    </div>\n  ',"\n      ").concat('\n    <div id="checklist-tab" class="tab-content" style="display: none; flex: 1; background: white; padding: 20px; overflow: auto; flex-direction: column;">\n      <div style="max-width: 600px; width: 100%; margin: 0 auto;">\n        <h3 style="margin-bottom: 8px; color: #333;">✅ Checklist Auto-Review</h3>\n        <p style="font-size: 14px; color: #666; margin-bottom: 20px;">\n          Automatically populate the checklist "Initials & Date" column with review data\n        </p>\n\n        \x3c!-- Instructions --\x3e\n        <div style="margin-bottom: 20px; padding: 12px; background: #f0f7ff; border-left: 3px solid #2196F3; border-radius: 4px;">\n          <div style="font-weight: 600; color: #1976D2; margin-bottom: 4px;">📋 How it works:</div>\n          <div style="font-size: 13px; color: #424242; line-height: 1.6;">\n            1. Ensure your document contains a checklist table<br>\n            2. Click "Auto-review Checklist" below<br>\n            3. The add-in will populate the "Initials & Date" column<br>\n            4. Each cell will have a comment with status, commentary, and references\n          </div>\n        </div>\n\n        \x3c!-- Action Button --\x3e\n        <div style="margin-bottom: 20px;">\n          <button id="auto-review-checklist-btn" style="width: 100%; padding: 14px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;">\n            🔍 Auto-review Checklist\n          </button>\n        </div>\n\n        \x3c!-- Progress Bar --\x3e\n        <div id="checklist-progress-container" style="display: none; margin-bottom: 16px;">\n          <div id="checklist-progress-text" style="font-size: 13px; color: #666; margin-bottom: 8px;">Processing...</div>\n          <div style="width: 100%; height: 8px; background: #f0f0f0; border-radius: 4px; overflow: hidden;">\n            <div id="checklist-progress-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); transition: width 0.3s ease;"></div>\n          </div>\n        </div>\n\n        \x3c!-- Status Display --\x3e\n        <div id="checklist-status">\n          \x3c!-- Populated by JavaScript --\x3e\n        </div>\n      </div>\n    </div>\n  ',"\n      ").concat('\n    <div id="ai-chat-tab" class="tab-content" style="display: none; flex: 1; background: white; padding: 0; flex-direction: column;">\n      <div id="iframe-status" style="padding: 12px; background: #e3f2fd; font-size: 12px; border-bottom: 1px solid #90caf9; font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', sans-serif;">\n        🔄 <strong>Loading chat widget...</strong><br/>\n        <span style="font-size: 11px; color: #666;">URL: '.concat("/chat/cmfivedyx0001c96zlzkskb7b",'</span><br/>\n        <span style="font-size: 10px; color: #999;">Waiting for response from server...</span>\n      </div>\n      <iframe\n        id="chat-widget-iframe"\n        src="').concat("/chat/cmfivedyx0001c96zlzkskb7b",'"\n        style="width: 100%; height: 100%; border: none; flex: 1; background: white;"\n        allow="clipboard-write"\n        sandbox="allow-scripts allow-forms allow-popups allow-same-origin allow-downloads allow-popups-to-escape-sandbox"\n      ></iframe>\n      <div style="padding: 8px; background: #f5f5f5; font-size: 10px; color: #666; border-top: 1px solid #ddd; text-align: center;">\n        If blank after 5 seconds, check: HTTPS enabled, CSP frame-ancestors set, no X-Frame-Options header\n      </div>\n    </div>\n  '),"\n    </div>\n  "),console.log("[Word] HTML injected successfully"),e=document.querySelectorAll(".tab-button"),t=document.querySelectorAll(".tab-content"),e.forEach(function(n){n.addEventListener("click",function(){var o=n.getAttribute("data-tab");e.forEach(function(e){e.classList.remove("active"),e.style.background="#1e1e1e",e.style.color="#999"}),t.forEach(function(e){e.classList.remove("active"),e.style.display="none"}),n.classList.add("active"),n.style.background="#2d2d2d",n.style.color="white";var r=document.getElementById("".concat(o,"-tab"));r&&(r.classList.add("active"),r.style.display="flex")})}),n=document.getElementById("ai-rewrite-btn"),o=document.getElementById("test-ping-btn"),n&&(n.onclick=p),o&&(o.onclick=P),console.log("[AI Chat] Tab initialized"),window.addEventListener("message",H),setTimeout(F(_().m(function e(){var t,n,o,r;return _().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=document.getElementById("iframe-status"),n=document.getElementById("chat-widget-iframe"),t){e.n=1;break}return e.a(2);case 1:return e.p=1,t.innerHTML='🔍 <strong>Testing connection...</strong><br/><span style="font-size: 11px;">Attempting to reach https://localhost:3001</span>',e.n=2,fetch("https://localhost:3001/chat/cmfivedyx0001c96zlzkskb7b",{method:"HEAD",mode:"no-cors"});case 2:e.v,t.innerHTML='📡 <strong>Server reachable!</strong><br/><span style="font-size: 11px;">Attempting to load in iframe...</span>',t.style.background="#d1ecf1",o=!1,n&&(n.onload=function(){o=!0,t.innerHTML='✅ <strong>Iframe loaded!</strong><br/><span style="font-size: 11px;">If you see blank content, check that the chat server is rendering HTML.</span>',t.style.background="#d4edda",t.style.color="#155724"},n.onerror=function(){t.innerHTML='❌ <strong>Iframe blocked by browser.</strong><br/><span style="font-size: 11px;">Likely: Certificate not trusted or X-Frame-Options blocking.</span>',t.style.background="#f8d7da",t.style.color="#721c24"},setTimeout(function(){o||(t.innerHTML='\n              ⚠️ <strong>Iframe not loading - Certificate Issue</strong><br/>\n              <span style="font-size: 11px;">Desktop Word doesn\'t trust the HTTPS certificate.</span><br/>\n              <span style="font-size: 10px; color: #856404;">\n                <strong>FIX:</strong> Open <a href="https://localhost:3001/chat/cmfivedyx0001c96zlzkskb7b" target="_blank" style="color: #0066cc;">this link</a> in your browser first, accept the certificate warning, then restart the add-in.\n              </span>\n            ',t.style.background="#fff3cd",t.style.color="#856404")},5e3)),e.n=4;break;case 3:e.p=3,r=e.v,t.innerHTML='\n        ❌ <strong>Cannot reach chat server</strong><br/>\n        <span style="font-size: 11px; color: #721c24;">Server not running or HTTPS certificate issue.</span><br/>\n        <span style="font-size: 10px;">Error: '.concat(r instanceof Error?r.message:"Unknown",'</span><br/>\n        <span style="font-size: 10px; margin-top: 8px; display: block;">\n          <strong>Steps to fix:</strong><br/>\n          1. Ensure chat server runs on https://localhost:3001<br/>\n          2. Open the URL in browser and accept certificate<br/>\n          3. Restart the add-in\n        </span>\n      '),t.style.background="#f8d7da",t.style.color="#721c24";case 4:return e.a(2)}},e,null,[[1,3]])})),500),(r=document.getElementById("auto-review-checklist-btn"))&&(r.onclick=U),console.log("[Word] All tabs initialized")):console.error("[Word] app-container not found!")}}}]);
//# sourceMappingURL=word-main.js.map